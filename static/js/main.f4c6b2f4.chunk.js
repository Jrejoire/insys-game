(this["webpackJsonpinsys-game"]=this["webpackJsonpinsys-game"]||[]).push([[0],{147:function(e,t,n){},155:function(e,t,n){e.exports=n(163)},160:function(e,t,n){},161:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var i=n(71),o=n.n(i),a=n(153),s=n.n(a),r=(n(160),n(161),n(147),n(100)),l=n(12),c=n(94),u=n(145),m=n(154),d=function(e){var t=Object(i.useRef)(null),n=(e.antialias,e.engineOptions,e.adaptToDeviceRatio,e.sceneOptions),a=e.onRender,s=(e.onSceneReady,Object(m.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady"])),r=Object(i.useState)(!1),c=Object(u.a)(r,2),d=c[0],h=c[1],p=Object(i.useState)(null),g=Object(u.a)(p,2),f=g[0],w=g[1];return Object(i.useEffect)((function(){if(window){var e=function(){f&&f.getEngine().resize()};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[f]),Object(i.useEffect)((function(){if(!d){h(!0);var i=new l.g(t.current,!0,{stencil:!0}),o=new l.o(i,n);w(o),o.isReady()?e.onSceneReady(o):o.onReadyObservable.addOnce((function(t){return e.onSceneReady(t)})),i.runRenderLoop((function(){"function"===typeof a&&a(o),o.render()}))}return function(){null!==f&&f.dispose()}}),[d,n,e,a,f]),o.a.createElement("canvas",Object.assign({ref:t},s))},h={tabForces:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:1,success:3},range:{roll:1,success:3,mods:{s:-1,m:1,l:0,xl:-1}},maxRange:1212,maxInGame:void 0,cost:10}}},sysTroops:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:1,success:3},range:{roll:2,success:4,mods:{s:0,m:1,l:-1,xl:-1}},maxRange:1212,maxInGame:void 0,cost:10}}},rebels:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:2,success:4},range:{roll:3,success:5,mods:{s:1,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}},outerRing:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:2,success:3},range:{roll:1,success:3,mods:{s:1,m:0,l:-2,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}},voidWarriors:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:4,success:5},range:{roll:3,success:5,mods:{s:0,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}}};l.b.AllowMatricesInterpolation=!0;var p=function(e){var t=e.getEngine().getRenderingCanvas(),n=new l.c("arcCamera",l.t.ToRadians(0),l.t.ToRadians(100),780,new l.u(-60,400,0),e);n.attachControl(t,!0),n.angularsensibility*=-1,n.checkCollisions=!0,n.ellipsoid=new l.u(1.5,1,1.5);var i=new l.m("pointLight",new l.u(75,400,150),e);i.intensity=1,i.range=5e3,new l.i("hemiLight",new l.u(0,-4900,0),e).intensity=.7;var o=new l.q(1024,i);o.usePoissonSampling=!0;var a=new l.j("hl1",e),s=new l.r("invisibleMaterial",e);s.alpha=0;var u=new l.r("transparentMaterial",e);u.alpha=.5;var m=l.l.CreateSphere("skyBox",{diameter:5500,diameterX:5500},e),d=new l.r("skyBox",e);d.backFaceCulling=!1,m.material=d,m.receiveShadows=!0;var p=l.l.CreateCylinder("background",{height:1,diameter:5e3,tessellation:5e3},e),g=new l.r("background",e);g.opacityTexture=new l.s("./Textures/OpacityTemplate.png",e),g.backFaceCulling=!1,p.material=g,p.translate(l.d.Y,-1,e),p.visibility=.4,p.receiveShadows=!0;var f=new l.r("boardMaterial",e);f.diffuseTexture=new l.s("./Textures/Wood/Wood_021_basecolor.jpg",e),f.bumpTexture=new l.s("./Textures/Wood/Wood_021_normal.jpg",e),f.ambientTexture=new l.s("./Textures/Wood/Wood_021_ambientOcclusion.jpg",e);var w=new l.r("asphaltMaterial",e);w.diffuseTexture=new l.s("./Textures/Asphalt/Asphalt_001_COLOR.jpg",e),w.bumpTexture=new l.s("./Textures/Asphalt/Asphalt_001_NRM.jpg",e),w.specularTexture=new l.s("./Textures/Asphalt/Asphalt_001_SPEC.jpg",e),w.ambientTexture=new l.s("./Textures/Asphalt/Asphalt_001_OCC.jpg",e);var v=new l.r("plasticMaterial",e);v.diffuseColor=new l.f(220/255,220/255,220/255);var M=new l.r("tokenMaterial",e);M.diffuseTexture=new l.s("./Textures/Token/Coin_low_Coin_material_BaseColor2.png",e),M.bumpTexture=new l.s("./Textures/Token/Coin_low_Coin_material_Normal.png",e);var y=new l.r("tokenMaterial",e);y.diffuseTexture=new l.s("./Textures/Token/Coin_low_Coin_material_BaseColor.png",e),y.bumpTexture=new l.s("./Textures/Token/Coin_low_Coin_material_Normal.png",e);var b=new l.r("baseMaterial",e);b.diffuseColor=new l.f.Black;var x=new l.r("baseMaterial",e);x.diffuseColor=new l.f.White;var k=new l.r("diceMatWhite",e);k.diffuseColor=new l.f.White;var C=new l.r("diceMatBlack",e);C.diffuseColor=new l.f(55/255,71/255,79/255);var E="if( vPositionW.z  < -340.){ discard; } if( vPositionW.z  > 340.){ discard; } if( vPositionW.x  > 450.){ discard; } if( vPositionW.x  < -450.){ discard; }",T=new c.a("moveAreaMat",e);T.alpha=.25,T.Fragment_Custom_Diffuse(E);var _=new c.a("losMatSW",e);_.alpha=.25,_.Fragment_Custom_Diffuse(E);var S=new c.a("losMatMW",e);S.alpha=.25,S.Fragment_Custom_Diffuse(E);var O=new c.a("losMatLW",e);O.alpha=.25,O.Fragment_Custom_Diffuse(E);var z=new c.a("losMatXLW",e);z.alpha=.25,z.Fragment_Custom_Diffuse(E);var W=new c.a("losMatSB",e);W.alpha=.25,W.Fragment_Custom_Diffuse(E);var A=new c.a("losMatMB",e);A.alpha=.25,A.Fragment_Custom_Diffuse(E);var B=new c.a("losMatLB",e);B.alpha=.25,B.Fragment_Custom_Diffuse(E);var P=new c.a("losMatXLB",e);P.alpha=.25,P.Fragment_Custom_Diffuse(E);var R,L,j,D,F,I,N,X={teamWhite:{player:"@jrej",army:"outerRing",get armyStats(){return h[this.army]},units:["soldier","soldier","soldier"],minis:[],startActions:6,turnActions:6,get armyValue(){var e=this;return this.units.reduce((function(t,n){return t+e.armyStats.units[n].cost}),0)}},teamBlack:{player:"@inkito",army:"tabForces",get armyStats(){return h[this.army]},units:["soldier","soldier","soldier"],minis:[],startActions:6,turnActions:6,get armyValue(){var e=this;return this.units.reduce((function(t,n){return t+e.armyStats.units[n].cost}),0)}}},G={team:"teamWhite",get player(){return X[this.team].player},get army(){return X[this.team].armyStats},get startActions(){return X[this.team].startActions},get turnActions(){return X[this.team].turnActions}},Y={get team(){return"teamWhite"===G.team?"teamBlack":"teamWhite"},get player(){return X["teamWhite"===G.team?"teamBlack":"teamWhite"].player},get army(){return X["teamWhite"===G.team?"teamBlack":"teamWhite"].armyStats}},Z=new l.a(e),U=new l.a(e),H=new l.a(e),J=new l.a(e),K=function(){l.p.ImportMesh("","./Models/","token.babylon",e,(function(e){(R=l.k.MergeMeshes(e)).position=new l.u(150,-18,440),R.scaling=new l.u(800,900,800),R.name="token",R.id="token1",R.material="teamWhite"===G.team?y:M;for(var t,n=R.position.x,i=G.startActions-1,o=0;o<i;o++){(t=R.clone("token".concat(o+2))).name="token";var a=Math.floor(40*Math.random())+50;t.position.x=n-a,t.position.z=R.position.z+Math.floor(30*Math.random())-15,n-=a}X[G.team].turnActions=X[G.team].startActions}))};K();var V=[];l.p.ImportMesh("","./Models/","dice.babylon",e,(function(t){(L=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),L.translate(l.d.Y,30,e),L.translate(l.d.X,175,e),L.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(L),L.id="dice1",L.name="dice",L.checkCollisions=!0,L.collisionGroup=1,L.collisionMask=1,L.setEnabled(!1),V.push(L)})),l.p.ImportMesh("","./Models/","dice2.babylon",e,(function(t){(j=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),j.translate(l.d.Y,33,e),j.translate(l.d.X,175,e),j.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(j),j.id="dice2",j.name="dice",j.checkCollisions=!0,j.collisionGroup=1,j.collisionMask=1,j.setEnabled(!1),V.push(j)})),l.p.ImportMesh("","./Models/","dice3.babylon",e,(function(t){(D=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),D.translate(l.d.Y,33,e),D.translate(l.d.X,175,e),D.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(D),D.id="dice3",D.name="dice",D.checkCollisions=!0,D.collisionGroup=1,D.collisionMask=1,D.setEnabled(!1),V.push(D)})),l.p.ImportMesh("","./Models/","dice4.babylon",e,(function(t){(F=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),F.translate(l.d.Y,33,e),F.translate(l.d.X,175,e),F.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(F),F.id="dice4",F.name="dice",F.checkCollisions=!0,F.collisionGroup=1,F.collisionMask=1,F.setEnabled(!1),V.push(F)})),l.p.ImportMesh("","./Models/","dice5.babylon",e,(function(t){(I=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),I.translate(l.d.Y,33,e),I.translate(l.d.X,175,e),I.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(I),I.id="dice5",I.name="dice",I.checkCollisions=!0,I.collisionGroup=1,I.collisionMask=1,I.setEnabled(!1),V.push(I)})),l.p.ImportMesh("","./Models/","dice6.babylon",e,(function(t){(N=l.k.MergeMeshes(t)).scaling=new l.u(20,20,20),N.translate(l.d.Y,33,e),N.translate(l.d.X,175,e),N.translate(l.d.Z,50,e),N.rotate(l.d.Y,l.t.ToRadians(90),e),o.getShadowMap().renderList.push(N),N.id="dice6",N.name="dice",N.checkCollisions=!0,N.collisionGroup=1,N.collisionMask=1,N.setEnabled(!1),V.push(N)}));var q=l.l.CreateCylinder("lineOfSights",{height:.1,diameter:429.25,tessellation:256},e);q.position=new l.u(0,100,0);var $=l.l.CreateCylinder("lineOfSightm",{height:.1,diameter:833.25,tessellation:256},e),Q=l.l.CreateCylinder("lineOfSightl",{height:.1,diameter:1641.25,tessellation:256},e);Q.parent=$.parent=q;var ee=l.e.FromMesh(q),te=l.e.FromMesh($),ne=l.e.FromMesh(Q),ie=l.l.CreateBox("LOSTemplate",{width:2*X[G.team].armyStats.units.soldier.maxRange,height:2500,depth:1},e);ie.rotate(l.d.X,l.t.ToRadians(90),e),ie.position=new l.u(X[G.team].armyStats.units.soldier.maxRange,100,0),ie.visibility=0;var oe=l.e.FromMesh(ie);ne=ne.subtract(oe).subtract(te).subtract(ee),te=te.subtract(oe).subtract(ee);var ae=(ee=ee.subtract(oe)).toMesh("lineOfSightS"),se=te.toMesh("lineOfSightM"),re=ne.toMesh("lineOfSightL");re.parent=se.parent=ae,re.isPickable=se.isPickable=!1,ae.setEnabled(!1),ie.dispose(),q.dispose(),$.dispose(),Q.dispose();var le,ce,ue,me,de,he,pe,ge,fe,we,ve=function(e,t,n){var i=new l.f(164/255,27/255,7/255),o=new l.f(215/255,195/255,58/255),a=new l.f(7/255,66/255,164/255),s=new l.f(7/255,164/255,27/255);return X[t].armyStats.units[e].range.mods[n]>0?s:0===X[t].armyStats.units[e].range.mods[n]?a:-1===X[t].armyStats.units[e].range.mods[n]?o:X[t].armyStats.units[e].range.mods[n]<=-2?i:void 0},Me=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.y*e.scaling.y},ye=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.x*e.scaling.x},be=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.z*e.scaling.z};l.p.ImportMesh("","./Models/","STLRW.babylon",e,(function(t){var n=l.l.CreateCylinder("whiteBase",{height:5.5,diameter:27,tessellation:128},e);n.material=b,n.translate(l.d.Y,25,e),n.translate(l.d.X,-300,e),(le=t[0]).translate(l.d.Y,25,e),le.translate(l.d.X,-300,e),le.name="blackMini",le.id="blackMini1",le.unit="soldier",le.rotation.y=l.t.ToRadians(-90),le.material=v,le.actionManager=H,le.enablePointerMoveEvents=!0,le.addChild(n),le.width=ye(le),le.height=Me(le),le.checkCollisions=!0,le.collisionGroup=1,le.collisionMask=1,(me=ae.clone()).parent=le,me.position=new l.u(0,1,0),me.rotation.y=l.t.ToRadians(-90),me.setEnabled(!1),me.material=W,me._children[0].material=A,me._children[1].material=B,W.diffuseColor=ve(le.unit,"teamBlack","s"),A.diffuseColor=ve(le.unit,"teamBlack","m"),B.diffuseColor=ve(le.unit,"teamBlack","l"),(ce=le.clone()).name="blackMini",ce.id="blackMini2",ce.unit="soldier",ce.material=v,ce.actionManager=H,ce.translate(l.d.Z,200,e),ce._children[1].setEnabled(!1),(ue=le.clone()).name="blackMini",ue.id="blackMini3",ue.unit="soldier",ue.material=v,ue.actionManager=H,ue.translate(l.d.Z,-200,e),(de=ue._children[1]).setEnabled(!1),o.getShadowMap().renderList.push(le,ce,ue),X.teamBlack.minis.push(le,ce,ue)})),l.p.ImportMesh("","./Models/","SKNCK.babylon",e,(function(t){var i=l.l.CreateCylinder("whiteBase",{height:5.5,diameter:27,tessellation:128},e);i.material=x,i.translate(l.d.Y,25,e),i.translate(l.d.X,300,e),(he=l.k.MergeMeshes(t)).translate(l.d.Y,25,e),he.translate(l.d.X,300,e),he.rotation.y=l.t.ToRadians(90),he.name="whiteMini",he.id="whiteMini1",he.unit="soldier",he.material=v,he.checkCollisions=!0,he.actionManager=J,he.collisionGroup=1,he.collisionMask=1,he.addChild(i),n.setTarget(he),he.width=ye(he),he.height=Me(he),(we=ae.clone()).parent=he,we.position=new l.u(0,1,0),we.rotation.y=l.t.ToRadians(-90),we.setEnabled(!1),we.material=_,we._children[0].material=S,we._children[1].material=O,_.diffuseColor=ve(he.unit,"teamWhite","s"),S.diffuseColor=ve(he.unit,"teamWhite","m"),O.diffuseColor=ve(he.unit,"teamWhite","l"),(pe=he.clone()).name="whiteMini",pe.id="whiteMini2",pe.unit="soldier",pe.material=v,pe.actionManager=J,pe.translate(l.d.Z,200,e),pe._children[1].setEnabled(!1),(ge=he.clone()).name="whiteMini",ge.id="whiteMini3",ge.unit="soldier",ge.material=v,ge.actionManager=J,ge.translate(l.d.Z,-200,e),ge._children[1].setEnabled(!1),o.getShadowMap().renderList.push(i,he,pe,ge),X.teamWhite.minis.push(he,pe,ge)}));var xe=[];l.p.ImportMesh("","./Models/","container.babylon",e,(function(t){var n=l.k.MergeMeshes(t);n.scaling=new l.u(2,2,2),n.translate(l.d.Y,50,e),n.translate(l.d.X,150,e),n.translate(l.d.Z,125,e),n.id="obstacle1",n.name="obstacle",n.receiveShadows=!0,n.width=ye(n),n.length=be(n),n.height=Me(n);var i=new l.r(e);i.diffuseColor=new l.f(.518,.271,.267);var a=new l.r(e);a.diffuseColor=new l.f(.671,.663,.733);var s=new l.r(e);s.diffuseColor=new l.f(.318,.502,.43);var r=n.clone("obstacle");r.position=new l.u(200,50,125),r.material=s;var c=n.clone("obstacle");c.position=new l.u(100,50,-125),c.material=i;var u=n.clone("obstacle");u.position=new l.u(150,50,-125);var m=n.clone("obstacle");m.position=new l.u(-100,50,125);var d=n.clone("obstacle");d.position=new l.u(-150,50,125),d.material=i;var h=n.clone("obstacle");h.position=new l.u(-200,50,-125),h.material=s;var p=n.clone("obstacle");p.position=new l.u(-150,50,-125),p.material=a;var g=n.clone("obstacle");g.position=new l.u(-175,100,-150),g.scaling.z=1;var f=n.clone("obstacle");f.position=new l.u(175,100,100),f.scaling.z=1,f.material=a;var w=n.clone("obstacle");w.position=new l.u(250,35,150),w.scaling.z=1,w.scaling.y=1,w.material=a;var v=n.clone("obstacle");v.position=new l.u(-250,35,-100),v.scaling.z=1,v.scaling.y=1,v.material=i,o.getShadowMap().renderList.push(n,r,c,u,m,d,h,p,g,f,w,v),xe.push(n,r,c,u,m,d,h,p,g,f,w,v)}));var ke=l.l.CreateCylinder("moveArea",{height:.25,diameter:202,tessellation:256},e);ke.material=s,ke.actionManager=U,ke.setEnabled(!1),ke.position=new l.u(0,27,0);var Ce,Ee,Te=l.l.CreateCylinder("moveArea",{height:.25,diameter:227.25,tessellation:256},e);Te.material=T,Te.parent=ke,l.p.ImportMesh("","./Models/","setting.babylon",e,(function(t){(Ce=t[0]).scaling=new l.u(1150,1200,1e3),Ce.material=f,o.getShadowMap().renderList.push(Ce),(Ee=l.l.CreateBox("map",{width:808,height:606,depth:1},e)).rotate(l.d.X,l.t.ToRadians(90),e),Ee.material=w,Ee.receiveShadows=!0,Ee.translate(l.d.Y,25,e),Ee.actionManager=Z}));var _e=function(){"teamWhite"===G.team?(G.team="teamBlack",n.position=new l.u(-700,300,0),De()):"teamBlack"===G.team&&(G.team="teamWhite",n.position=new l.u(700,300,0),De()),K()},Se="",Oe=!1,ze={position:null,rotation:null},We=function(t){if(1===t.sourceEvent.which){var n=t.meshUnderPointer;e.hoverCursor="pointer",Se===n?Ze({skip:!0}):n.id.includes("Mini")&&(Se&&a.removeMesh(Se),G.turnActions>0&&(a.addMesh(n,l.f.White()),a.addMesh(ke,l.f.White()),Se=n,ze.position=Se.position,ke.position=new l.u(n.position.x,n.position.y+2,n.position.z),ke.setEnabled(!0)))}},Ae=function(){Se&&Oe?ze.position&&(Se.position=ze.position,Se.rotation=ze.rotation,ke.setEnabled(!0),ke.position=new l.u(ze.position.x,ze.position.y+2,ze.position.z),Se._children[1].setEnabled(!1),t.removeEventListener("mousemove",He),Oe=!1):Se&&!Oe&&(ke.setEnabled(!1),a.removeMesh(Se),a.removeMesh(ke),e.removeMesh(fe),Se._children[1].setEnabled(!1),De(),Se="",e.hoverCursor="pointer",fe&&fe.dispose())},Be=function(t,n){var i=new l.u(t.position.x,t.position.y+.75*Me(t),t.position.z),o=new l.u(n.position.x,n.position.y+.75*Me(n),n.position.z-n.width/2+.25*n.width),a=new l.u(n.position.x,n.position.y+.75*Me(n),n.position.z+n.width/2-.25*n.width),s=o.subtract(i);s=l.u.Normalize(s);var r=a.subtract(i);r=l.u.Normalize(r);var c=l.u.Distance(t.position,n.position)-ye(n)/2,u=new l.n(i,s,c),m=new l.n(i,r,c),d=e.multiPickWithRay(u),h=e.multiPickWithRay(m);return!d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||!h.some((function(e){return e.pickedMesh.name.includes("obstacle")}))},Pe=function(t,n){var i=new l.u(t.position.x,t.position.y+5,t.position.z-t.width/2+.25*t.width),o=new l.u(t.position.x,t.position.y+5,t.position.z+t.width/2-.25*t.width),a=new l.u(n.position.x,n.position.y+5,n.position.z),s=a.subtract(i);s=l.u.Normalize(s);var r=a.subtract(o);r=l.u.Normalize(r);var c=t.width/2+t.width,u=new l.n(i,s,c),m=new l.n(o,r,c),d=e.multiPickWithRay(u),h=e.multiPickWithRay(m);return d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||h.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?(console.log(t.name+" is in cover!"),!0):(console.log(t.name+" is NOT in cover!"),!1)},Re=function(e,t){var n=Ue(e),i=new l.u(e.position.x,55,e.position.z),o=new l.u(t.position.x,55,t.position.z).subtract(i);return o=l.u.Normalize(o),!(180*Math.acos(l.u.Dot(n,o))/Math.PI>90)},Le=function(e){var t=e.meshUnderPointer;Se&&Be(Se,t)&&(t.intersectsMesh(Se,!1)||(Xe(Se,t)?(Se._children[1].setEnabled(!0),ke.setEnabled(!1)):t.intersectsMesh(Se,!1)||Xe(Se,t)||(ke.setEnabled(!1),Se._children[1].setEnabled(!0))))},je=function(){Se&&(Se._children[1].setEnabled(!1),Oe||ke.setEnabled(!0)),e.hoverCursor="pointer"},De=function(){if(X[G.team].minis){var t=X[G.team].minis.map((function(e){return e.position.x})),i="teamWhite"===G.team?t.indexOf(Math.min.apply(Math,Object(r.a)(t))):t.indexOf(Math.max.apply(Math,Object(r.a)(t))),o=X[G.team].minis[i],a=l.k.CreateSphere("targetSphere",{size:10},e);a.visibility=0,a.position=new l.u(o.position.x,o.position.y,0),n.setTarget(a),setTimeout((function(){a.dispose()}),1100)}},Fe=function(e,t,n,i){for(var o=[],a=0;a<e;a++)o.push(Math.floor(6*Math.random())+1);return o},Ie=function(t,n,i){for(var o=new l.u(n.position.x+10,n.position.y+7,n.position.z+30),a=new l.u(n.position.x+10,n.position.y+7,n.position.z+45),s=new l.u(n.position.x+-5,n.position.y+7,n.position.z+30),r=new l.u(n.position.x+-5,n.position.y+7,n.position.z+37.5),c=new l.u(n.position.x+-5,n.position.y+7,n.position.z+45),u=new l.u(n.position.x+-20,n.position.y+7,n.position.z+30),m=new l.u(n.position.x+-20,n.position.y+7,n.position.z+37.5),d=[o,a,s,c,u,new l.u(n.position.x+-20,n.position.y+7,n.position.z+45)],h=function(o){g=o+1,n.name.includes("white")?V[t[o]-1].material=k:V[t[o]-1].material=C,3===t.length&&3===g?V[t[o]-1].clone("diceClone".concat(o)).position=r:5===t.length&&5===g?V[t[o]-1].clone("diceClone".concat(o)).position=m:V[t[o]-1].clone("diceClone".concat(o)).position=d[o],setTimeout((function(){e.removeMesh(e.getMeshByName("diceClone".concat(o)))}),i)},p=0;p<t.length;p++){var g;h(p)}},Ne=function(e,t,n,i){var o=e.filter((function(e){return e+t>=G.army.units.soldier.range.success})),a=n.filter((function(e){return e+i>=Y.army.units.soldier.range.success}));console.log("Player rolls:"),console.log(e),console.log("He has a "+t+" modifier to dice roll"),console.log("Enemy rolls:"),console.log(n),console.log("He has a "+i+" modifier to dice roll"),console.log("Player success rolls:"),console.log(o),console.log("Enemy Success rolls:"),console.log(a);for(var s=0;s<o.length;s++)for(var l=0;l<a.length;l++)o[s]===a[l]&&(o.splice(s,1),a.splice(l,1));return Math.max.apply(Math,Object(r.a)(o))>Math.max.apply(Math,Object(r.a)(a))?(console.log("Player wins with a higher roll!"),"player"):Math.max.apply(Math,Object(r.a)(a))>Math.max.apply(Math,Object(r.a)(o))?(console.log("Enemy wins with a higher roll!"),"enemy"):null},Xe=function(e,t){var n,i=l.u.Distance(e.position,t.position)-t.width/2,o="whiteMini"===e.name?"teamWhite":"teamBlack",a=X[o].armyStats.units[e.unit].maxRange;return i<=e.width/2+t.width/2?n="c":i<=202?n="s":i>202&&i<=404?n="m":i>404&&i<=808?n="l":i>808&&i<=a?n="xl":i>a&&(n=null),Be(e,t)&&Re(e,t)?n:null},Ge=function(){var e="";return 0===X.teamBlack.startActions&&0===X.teamWhite.startActions?(console.log("tie"),e=null,console.log("Game Over. No Winners this time.")):0===X.teamBlack.startActions?(e="Team White",console.log("Game Over. ".concat(e," wins!"))):0===X.teamWhite.startActions?(e="Team Black",console.log("Game Over. ".concat(e," wins!"))):e=void 0,e},Ye=function(t){var i=t.meshUnderPointer,o="";if(Se){var a=Se,s=Xe(Se,i),r=Pe(Se,i)?1:0,c=r+G.army.units[Se.unit].range.mods[s],u=Pe(i,Se)?1:0,m=u+Y.army.units[i.unit].range.mods[s];if(s&&Re(Se,i)){if(i.intersectsMesh(Se,!1)||"c"===s){console.log("Stabbing "+i.id+" with "+Se.id),console.log("Player target roll: "+G.army.units[Se.unit].melee.success+"+");var d=Fe(G.army.units[Se.unit].melee.roll);Ie(d,Se,1e3),console.log("Enemy target roll: "+Y.army.units[Se.unit].melee.success+"+");var h=Fe(1);Ie(h,i,1e3),o=Ne(d,0,h,0)}else{var p=[],g=[],f=[];console.log("Shooting ".concat(i.id," with ").concat(Se.id," at range ").concat(s,".")),console.log("Player target roll: "+G.army.units[Se.unit].range.success+"+"),p=Fe(G.army.units[Se.unit].range.roll),Ie(p,Se,1e3),g=p.map((function(e){return e+c})),Xe(i,Se)&&(console.log("Enemy target roll: "+Y.army.units[i.unit].range.success+"+"),f=Fe(1),Ie(f,i,1e3),o=Ne(p,c,f,m)),o||g.some((function(e){return e>=G.army.units[Se.unit].range.success}))&&(console.log("Success! You shot him!"),o="player")}if("player"===o){console.log("Enemy is hit. Defense roll target: "+Y.army.units[i.unit].defense.success+"+"),u>0&&console.log("Enemy has +1 to dice roll as he is in cover.");var w=Fe(Y.army.units[i.unit].defense.roll);console.log("Enemy rolls : "),console.log(w),setTimeout((function(){Ie(w,i,1250)}),1250),w.some((function(e){return e+u>=Y.army.units[i.unit].defense.success}))?console.log("Defense roll successful. Enemy saved!"):(console.log("Enemy killed!"),setTimeout((function(){i.position=new l.u(Math.floor(190*Math.random())-200,0,-440+Math.floor(30*Math.random())-15),i.name="decor",i.isPickable=!1,X[Y.team].minis=X[Y.team].minis.filter((function(e){return e.id!==i.id})),X[Y.team].startActions-=2,Ge(),Ae()}),2500))}else if("enemy"===o){console.log("Player is hit. Defense roll target: "+G.army.units[Se.unit].defense.success+"+"),r>0&&console.log("Player has +1 to dice roll as he is in cover.");var v=Fe(G.army.units[Se.unit].defense.roll);console.log("Player rolls : "),console.log(v),setTimeout((function(){Ie(v,a,1250)}),1250),v.some((function(e){return e+r>=G.army.units[Se.unit].defense.success}))?console.log("Defense roll successful. Player mini saved!"):(console.log("Player killed!"),setTimeout((function(){n.target=Ee,a.position=new l.u(200-Math.floor(190*Math.random()),0,-440+Math.floor(30*Math.random())-15),a.name="decor",a.isPickable=!1,X[G.team].minis=X[G.team].minis.filter((function(e){return e.id!==a.id})),X[G.team].startActions-=2,Ge(),Ae()}),2500))}else console.log("No winners! Try again.");X[G.team].turnActions-=1,e.removeMesh(e.getMeshByName("token")),Ae(),0===X[G.team].turnActions&&setTimeout((function(){_e()}),3e3)}}},Ze=function(e){var t=e.skip;Se&&(t||(ze.position=Se.position,Se.position=fe.position),ke.position=new l.u(Se.position.x,Se.position.y+2,Se.position.z),ke.setEnabled(!1),Se._children[1].setEnabled(!0),ze.rotation=Se.rotation.clone(),Oe=!0)},Ue=function(e){var t=new l.u(0,0,-1),n=e.getDirection(t);return n.normalize(),n},He=function(e){if(e.preventDefault(),Se&&Ve(e)){var t=Se.position.x-Ve(e).x,n=Se.position.z-Ve(e).z;Se.rotation.y=Math.atan2(t,n)}},Je=function(t){1!==t.which&&1!==t.sourceEvent.which||Se&&Oe&&(X[G.team].turnActions-=1,e.removeMesh(e.getMeshByName("token")),Oe=!1,ze.position=null,ze.rotation=null,Ae(),0===X[G.team].turnActions&&setTimeout((function(){_e()}),1e3))},Ke=function(e){if((e.preventDefault(),Se&&Ve(e))&&(![].concat(Object(r.a)(X[Y.team].minis),Object(r.a)(X[G.team].minis.filter((function(e){return e.id!==Se.id})))).some((function(t){return Ve(e).x<t.position.x+ye(t)-2&&Ve(e).x>t.position.x-ye(t)+2&&Ve(e).z<t.position.z+ye(t)-2&&Ve(e).z>t.position.z-ye(t)+2}))&&!xe.filter((function(e){return Me(e)+e.position.y-Me(e)/2>Me(Se)+Se.position.y})).some((function(t){return Ve(e).x<t.position.x+ye(t)/2+ye(Se)/2&&Ve(e).x>t.position.x-ye(t)/2-ye(Se)/2&&Ve(e).z<t.position.z+be(t)/2+ye(Se)/2&&Ve(e).z>t.position.z-be(t)/2-ye(Se)/2}))&&Ve(e).x>-388&&Ve(e).x<388&&Ve(e).z>-285&&Ve(e).z<285)){var t=xe.filter((function(e){return Me(e)<Me(Se)+Se.position.y-25})).filter((function(t){return Ve(e).x<t.position.x+ye(t)/2+ye(Se)/2&&Ve(e).x>t.position.x-ye(t)/2-ye(Se)/2&&Ve(e).z<t.position.z+be(t)/2+ye(Se)/2&&Ve(e).z>t.position.z-be(t)/2-ye(Se)/2}));t&&t.length>0?fe.position=new l.u(Ve(e).x,Me(t[0])+26,Ve(e).z):fe.position=new l.u(Ve(e).x,25,Ve(e).z)}},Ve=function(){var t=e.pick(e.pointerX,e.pointerY,(function(e){return e===Ee}));return t.hit?t.pickedPoint:null};U.registerAction(new l.h(l.a.OnPointerOverTrigger,(function(e){(fe=Se.clone()).position=Se.position,fe.isPickable=!1,fe._children[1].setEnabled(!1),de.setEnabled(!1),fe.material=u,t.addEventListener("mousemove",Ke,!1),t.addEventListener("click",Ze,!1)}))),U.registerAction(new l.h(l.a.OnPointerOutTrigger,(function(e){fe.dispose(),t.removeEventListener("mousemove",Ke),t.removeEventListener("click",Ze)}))),Z.registerAction(new l.h(l.a.OnPointerOverTrigger,(function(e){Se&&Oe&&Se._children[1].setEnabled(!0),Oe&&(t.addEventListener("mousemove",He,!1),t.addEventListener("click",Je,!1))}))),Z.registerAction(new l.h(l.a.OnPointerOutTrigger,(function(e){Se&&!Oe&&Se._children[1].setEnabled(!1),t.removeEventListener("mousemove",He),t.removeEventListener("click",Je)}))),H.registerAction(new l.h(l.a.OnPickUpTrigger,(function(e){"teamBlack"===G.team&&(Oe?Je(e):We(e))}))),H.registerAction(new l.h(l.a.OnLeftPickTrigger,(function(e){"teamWhite"!==G.team||Oe||Ye(e)}))),H.registerAction(new l.h(l.a.OnPointerOverTrigger,(function(e){"teamWhite"===G.team&&Le(e)}))),H.registerAction(new l.h(l.a.OnPointerOutTrigger,(function(e){"teamWhite"===G.team&&je()}))),J.registerAction(new l.h(l.a.OnPickUpTrigger,(function(e){"teamWhite"===G.team&&(Oe?Je(e):We(e))}))),J.registerAction(new l.h(l.a.OnLeftPickTrigger,(function(e){"teamBlack"!==G.team||Oe||Ye(e)}))),J.registerAction(new l.h(l.a.OnPointerOverTrigger,(function(e){"teamBlack"===G.team&&Le(e)}))),J.registerAction(new l.h(l.a.OnPointerOutTrigger,(function(e){"teamBlack"===G.team&&je()}))),t.addEventListener("contextmenu",Ae,!1),e.onDispose=function(){t.removeEventListener("mousemove",Ke),t.removeEventListener("contextmenu",Ae)}},g=function(){return o.a.createElement("div",null,o.a.createElement(d,{className:"w-full h-full",antialias:!0,onSceneReady:p,id:"my-canvas"}))},f=function(){return o.a.createElement("div",{className:"w-full h-full"},o.a.createElement(g,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[155,1,2]]]);
//# sourceMappingURL=main.f4c6b2f4.chunk.js.map