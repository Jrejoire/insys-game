(this["webpackJsonpinsys-game"]=this["webpackJsonpinsys-game"]||[]).push([[0],{150:function(e,n,t){},160:function(e,n,t){e.exports=t(167)},165:function(e,n,t){},166:function(e,n,t){},167:function(e,n,t){"use strict";t.r(n);var i=t(60),o=t.n(i),a=t(158),s=t.n(a),r=(t(165),t(166),t(150),t(95)),l=t(10),c=t(148),u=t(159),m=t(99),d=function(e){var n=Object(i.useRef)(null),t=(e.antialias,e.engineOptions,e.adaptToDeviceRatio,e.sceneOptions),a=e.onRender,s=(e.onSceneReady,Object(u.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady"])),r=Object(i.useState)(!1),l=Object(c.a)(r,2),d=l[0],p=l[1],h=Object(i.useState)(null),g=Object(c.a)(h,2),f=g[0],w=g[1];return Object(i.useEffect)((function(){if(window){var e=function(){f&&f.getEngine().resize()};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[f]),Object(i.useEffect)((function(){if(!d){p(!0);var i=new m.Engine(n.current,!0,{stencil:!0}),o=new m.Scene(i,t);w(o),o.isReady()?e.onSceneReady(o):o.onReadyObservable.addOnce((function(n){return e.onSceneReady(n)})),i.runRenderLoop((function(){"function"===typeof a&&a(o),o.render()}))}return function(){null!==f&&f.dispose()}}),[d,t,e,a,f]),o.a.createElement("canvas",Object.assign({ref:n},s))},p={tabForces:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:1,success:3},range:{roll:1,success:3,mods:{s:-1,m:1,l:0,xl:-1}},maxRange:1212,maxInGame:void 0,cost:10}}},sysTroops:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:1,success:3},range:{roll:2,success:4,mods:{s:0,m:1,l:-1,xl:-1}},maxRange:1212,maxInGame:void 0,cost:10}}},rebels:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:2,success:4},range:{roll:3,success:5,mods:{s:1,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}},outerRing:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:2,success:3},range:{roll:1,success:3,mods:{s:1,m:0,l:-2,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}},voidWarriors:{units:{soldier:{class:"FS",move:4,defense:{roll:1,success:4},melee:{roll:4,success:5},range:{roll:3,success:5,mods:{s:0,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:10}}}};l.b.AllowMatricesInterpolation=!0;var h=function(e){var n=e.getEngine().getRenderingCanvas(),t=new l.c("arcCamera",l.r.ToRadians(0),l.r.ToRadians(100),780,new l.s(-60,400,0),e);t.attachControl(n,!0),t.angularsensibility*=-1,t.checkCollisions=!0,t.ellipsoid=new l.s(1.5,1,1.5);var i=new l.l("pointLight",new l.s(75,400,150),e);i.intensity=1,i.range=5e3,new l.h("hemiLight",new l.s(0,-4900,0),e).intensity=.7;var o=new l.o(1024,i);o.usePoissonSampling=!0;var a=new l.i("hl1",e),s=new l.p("invisibleMaterial",e);s.alpha=0;var c=new l.p("transparentMaterial",e);c.alpha=.5;var u=l.k.CreateSphere("skyBox",{diameter:5500,diameterX:5500},e),m=new l.p("skyBox",e);m.backFaceCulling=!1,u.material=m,u.receiveShadows=!0;var d=l.k.CreateCylinder("background",{height:1,diameter:5e3,tessellation:5e3},e),h=new l.p("background",e);h.opacityTexture=new l.q("./Textures/OpacityTemplate.png",e),h.backFaceCulling=!1,d.material=h,d.translate(l.d.Y,-1,e),d.visibility=.4,d.receiveShadows=!0;var g=new l.p("boardMaterial",e);g.diffuseTexture=new l.q("./Textures/Wood/Wood_021_basecolor.jpg",e),g.bumpTexture=new l.q("./Textures/Wood/Wood_021_normal.jpg",e),g.ambientTexture=new l.q("./Textures/Wood/Wood_021_ambientOcclusion.jpg",e);var f=new l.p("asphaltMaterial",e);f.diffuseTexture=new l.q("./Textures/Asphalt/Asphalt_001_COLOR.jpg",e),f.bumpTexture=new l.q("./Textures/Asphalt/Asphalt_001_NRM.jpg",e),f.specularTexture=new l.q("./Textures/Asphalt/Asphalt_001_SPEC.jpg",e),f.ambientTexture=new l.q("./Textures/Asphalt/Asphalt_001_OCC.jpg",e);var w=new l.p("plasticMaterial",e);w.diffuseColor=new l.f(220/255,220/255,220/255);var v=new l.p("tokenMaterial",e);v.diffuseTexture=new l.q("./Textures/Token/Coin_low_Coin_material_BaseColor2.png",e),v.bumpTexture=new l.q("./Textures/Token/Coin_low_Coin_material_Normal.png",e);var M=new l.p("tokenMaterial",e);M.diffuseTexture=new l.q("./Textures/Token/Coin_low_Coin_material_BaseColor.png",e),M.bumpTexture=new l.q("./Textures/Token/Coin_low_Coin_material_Normal.png",e);var y=new l.p("baseMaterial",e);y.diffuseColor=new l.f.Black;var b=new l.p("baseMaterial",e);b.diffuseColor=new l.f.White;var x=new l.p("diceMatWhite",e);x.diffuseColor=new l.f.White;var k=new l.p("diceMatBlack",e);k.diffuseColor=new l.f(55/255,71/255,79/255);var C=new l.p("moveAreaMat",e);C.alpha=.25;var E=new l.p("losMatSW",e);E.alpha=.25;var T=new l.p("losMatMW",e);T.alpha=.25;var S=new l.p("losMatLW",e);S.alpha=.25,new l.p("losMatXLW",e).alpha=.25;var O=new l.p("losMatSB",e);O.alpha=.25;var z=new l.p("losMatMB",e);z.alpha=.25;var W=new l.p("losMatLB",e);W.alpha=.25,new l.p("losMatXLB",e).alpha=.25;var _,A,B,R,P,L,j,I={teamWhite:{player:"@jrej",army:"outerRing",get armyStats(){return p[this.army]},units:["soldier","soldier","soldier"],minis:[],startActions:6,turnActions:6,get armyValue(){var e=this;return this.units.reduce((function(n,t){return n+e.armyStats.units[t].cost}),0)}},teamBlack:{player:"@inkito",army:"tabForces",get armyStats(){return p[this.army]},units:["soldier","soldier","soldier"],minis:[],startActions:6,turnActions:6,get armyValue(){var e=this;return this.units.reduce((function(n,t){return n+e.armyStats.units[t].cost}),0)}}},N={team:"teamWhite",get player(){return I[this.team].player},get army(){return I[this.team].armyStats},get startActions(){return I[this.team].startActions},get turnActions(){return I[this.team].turnActions}},X={get team(){return"teamWhite"===N.team?"teamBlack":"teamWhite"},get player(){return I["teamWhite"===N.team?"teamBlack":"teamWhite"].player},get army(){return I["teamWhite"===N.team?"teamBlack":"teamWhite"].armyStats}},G=new l.a(e),Y=new l.a(e),D=new l.a(e),F=new l.a(e),q=function(){l.n.ImportMesh("","./Models/","token.babylon",e,(function(e){(_=l.j.MergeMeshes(e)).position=new l.s(150,-18,440),_.scaling=new l.s(800,900,800),_.name="token",_.id="token1",_.material="teamWhite"===N.team?M:v;for(var n,t=_.position.x,i=N.startActions-1,o=0;o<i;o++){(n=_.clone("token".concat(o+2))).name="token";var a=Math.floor(40*Math.random())+50;n.position.x=t-a,n.position.z=_.position.z+Math.floor(30*Math.random())-15,t-=a}I[N.team].turnActions=I[N.team].startActions}))};q();var Z=[];l.n.ImportMesh("","./Models/","dice.babylon",e,(function(n){(A=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),A.translate(l.d.Y,30,e),A.translate(l.d.X,175,e),A.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(A),A.id="dice1",A.name="dice",A.checkCollisions=!0,A.collisionGroup=1,A.collisionMask=1,A.setEnabled(!1),Z.push(A)})),l.n.ImportMesh("","./Models/","dice2.babylon",e,(function(n){(B=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),B.translate(l.d.Y,33,e),B.translate(l.d.X,175,e),B.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(B),B.id="dice2",B.name="dice",B.checkCollisions=!0,B.collisionGroup=1,B.collisionMask=1,B.setEnabled(!1),Z.push(B)})),l.n.ImportMesh("","./Models/","dice3.babylon",e,(function(n){(R=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),R.translate(l.d.Y,33,e),R.translate(l.d.X,175,e),R.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(R),R.id="dice3",R.name="dice",R.checkCollisions=!0,R.collisionGroup=1,R.collisionMask=1,R.setEnabled(!1),Z.push(R)})),l.n.ImportMesh("","./Models/","dice4.babylon",e,(function(n){(P=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),P.translate(l.d.Y,33,e),P.translate(l.d.X,175,e),P.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(P),P.id="dice4",P.name="dice",P.checkCollisions=!0,P.collisionGroup=1,P.collisionMask=1,P.setEnabled(!1),Z.push(P)})),l.n.ImportMesh("","./Models/","dice5.babylon",e,(function(n){(L=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),L.translate(l.d.Y,33,e),L.translate(l.d.X,175,e),L.translate(l.d.Z,50,e),o.getShadowMap().renderList.push(L),L.id="dice5",L.name="dice",L.checkCollisions=!0,L.collisionGroup=1,L.collisionMask=1,L.setEnabled(!1),Z.push(L)})),l.n.ImportMesh("","./Models/","dice6.babylon",e,(function(n){(j=l.j.MergeMeshes(n)).scaling=new l.s(20,20,20),j.translate(l.d.Y,33,e),j.translate(l.d.X,175,e),j.translate(l.d.Z,50,e),j.rotate(l.d.Y,l.r.ToRadians(90),e),o.getShadowMap().renderList.push(j),j.id="dice6",j.name="dice",j.checkCollisions=!0,j.collisionGroup=1,j.collisionMask=1,j.setEnabled(!1),Z.push(j)}));var U=l.k.CreateCylinder("lineOfSights",{height:.1,diameter:429.25,tessellation:256},e);U.position=new l.s(0,100,0);var H=l.k.CreateCylinder("lineOfSightm",{height:.1,diameter:833.25,tessellation:256},e),J=l.k.CreateCylinder("lineOfSightl",{height:.1,diameter:1641.25,tessellation:256},e);J.parent=H.parent=U;var K=l.e.FromMesh(U),V=l.e.FromMesh(H),$=l.e.FromMesh(J),Q=l.k.CreateBox("LOSTemplate",{width:2*I[N.team].armyStats.units.soldier.maxRange,height:2500,depth:1},e);Q.rotate(l.d.X,l.r.ToRadians(90),e),Q.position=new l.s(I[N.team].armyStats.units.soldier.maxRange,100,0),Q.visibility=0;var ee=l.e.FromMesh(Q);$=$.subtract(ee).subtract(V).subtract(K),V=V.subtract(ee).subtract(K);var ne=(K=K.subtract(ee)).toMesh("lineOfSightS"),te=V.toMesh("lineOfSightM"),ie=$.toMesh("lineOfSightL");ie.parent=te.parent=ne,ie.isPickable=te.isPickable=!1,ne.setEnabled(!1),Q.dispose(),U.dispose(),H.dispose(),J.dispose();var oe,ae,se,re,le,ce,ue,me,de,pe,he=function(e,n,t){var i=new l.f(164/255,27/255,7/255),o=new l.f(215/255,195/255,58/255),a=new l.f(7/255,66/255,164/255),s=new l.f(7/255,164/255,27/255);return I[n].armyStats.units[e].range.mods[t]>0?s:0===I[n].armyStats.units[e].range.mods[t]?a:-1===I[n].armyStats.units[e].range.mods[t]?o:I[n].armyStats.units[e].range.mods[t]<=-2?i:void 0},ge=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.y*e.scaling.y},fe=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.x*e.scaling.x},we=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.z*e.scaling.z};l.n.ImportMesh("","./Models/","STLRW.babylon",e,(function(n){var t=l.k.CreateCylinder("whiteBase",{height:5.5,diameter:27,tessellation:128},e);t.material=y,t.translate(l.d.Y,25,e),t.translate(l.d.X,-300,e),(oe=n[0]).translate(l.d.Y,25,e),oe.translate(l.d.X,-300,e),oe.name="blackMini",oe.id="blackMini1",oe.unit="soldier",oe.rotation.y=l.r.ToRadians(-90),oe.material=w,oe.actionManager=D,oe.enablePointerMoveEvents=!0,oe.addChild(t),oe.width=fe(oe),oe.height=ge(oe),oe.checkCollisions=!0,oe.collisionGroup=1,oe.collisionMask=1,(re=ne.clone()).parent=oe,re.position=new l.s(0,1,0),re.rotation.y=l.r.ToRadians(-90),re.setEnabled(!1),re.material=O,re._children[0].material=z,re._children[1].material=W,O.diffuseColor=he(oe.unit,"teamBlack","s"),z.diffuseColor=he(oe.unit,"teamBlack","m"),W.diffuseColor=he(oe.unit,"teamBlack","l"),(ae=oe.clone()).name="blackMini",ae.id="blackMini2",ae.unit="soldier",ae.material=w,ae.actionManager=D,ae.translate(l.d.Z,200,e),ae._children[1].setEnabled(!1),(se=oe.clone()).name="blackMini",se.id="blackMini3",se.unit="soldier",se.material=w,se.actionManager=D,se.translate(l.d.Z,-200,e),(le=se._children[1]).setEnabled(!1),o.getShadowMap().renderList.push(oe,ae,se),I.teamBlack.minis.push(oe,ae,se)})),l.n.ImportMesh("","./Models/","SKNCK.babylon",e,(function(n){var i=l.k.CreateCylinder("whiteBase",{height:5.5,diameter:27,tessellation:128},e);i.material=b,i.translate(l.d.Y,25,e),i.translate(l.d.X,300,e),(ce=l.j.MergeMeshes(n)).translate(l.d.Y,25,e),ce.translate(l.d.X,300,e),ce.rotation.y=l.r.ToRadians(90),ce.name="whiteMini",ce.id="whiteMini1",ce.unit="soldier",ce.material=w,ce.checkCollisions=!0,ce.actionManager=F,ce.collisionGroup=1,ce.collisionMask=1,ce.addChild(i),t.setTarget(ce),ce.width=fe(ce),ce.height=ge(ce),(pe=ne.clone()).parent=ce,pe.position=new l.s(0,1,0),pe.rotation.y=l.r.ToRadians(-90),pe.setEnabled(!1),pe.material=E,pe._children[0].material=T,pe._children[1].material=S,E.diffuseColor=he(ce.unit,"teamWhite","s"),T.diffuseColor=he(ce.unit,"teamWhite","m"),S.diffuseColor=he(ce.unit,"teamWhite","l"),(ue=ce.clone()).name="whiteMini",ue.id="whiteMini2",ue.unit="soldier",ue.material=w,ue.actionManager=F,ue.translate(l.d.Z,200,e),ue._children[1].setEnabled(!1),(me=ce.clone()).name="whiteMini",me.id="whiteMini3",me.unit="soldier",me.material=w,me.actionManager=F,me.translate(l.d.Z,-200,e),me._children[1].setEnabled(!1),o.getShadowMap().renderList.push(i,ce,ue,me),I.teamWhite.minis.push(ce,ue,me)}));var ve=[];l.n.ImportMesh("","./Models/","container.babylon",e,(function(n){var t=l.j.MergeMeshes(n);t.scaling=new l.s(2,2,2),t.translate(l.d.Y,50,e),t.translate(l.d.X,150,e),t.translate(l.d.Z,125,e),t.id="obstacle1",t.name="obstacle",t.receiveShadows=!0,t.width=fe(t),t.length=we(t),t.height=ge(t);var i=new l.p(e);i.diffuseColor=new l.f(.518,.271,.267);var a=new l.p(e);a.diffuseColor=new l.f(.671,.663,.733);var s=new l.p(e);s.diffuseColor=new l.f(.318,.502,.43);var r=t.clone("obstacle");r.position=new l.s(200,50,125),r.material=s;var c=t.clone("obstacle");c.position=new l.s(100,50,-125),c.material=i;var u=t.clone("obstacle");u.position=new l.s(150,50,-125);var m=t.clone("obstacle");m.position=new l.s(-100,50,125);var d=t.clone("obstacle");d.position=new l.s(-150,50,125),d.material=i;var p=t.clone("obstacle");p.position=new l.s(-200,50,-125),p.material=s;var h=t.clone("obstacle");h.position=new l.s(-150,50,-125),h.material=a;var g=t.clone("obstacle");g.position=new l.s(-175,100,-150),g.scaling.z=1;var f=t.clone("obstacle");f.position=new l.s(175,100,100),f.scaling.z=1,f.material=a;var w=t.clone("obstacle");w.position=new l.s(250,35,150),w.scaling.z=1,w.scaling.y=1,w.material=a;var v=t.clone("obstacle");v.position=new l.s(-250,35,-100),v.scaling.z=1,v.scaling.y=1,v.material=i,o.getShadowMap().renderList.push(t,r,c,u,m,d,p,h,g,f,w,v),ve.push(t,r,c,u,m,d,p,h,g,f,w,v)}));var Me=l.k.CreateCylinder("moveArea",{height:.25,diameter:202,tessellation:256},e);Me.material=s,Me.actionManager=Y,Me.setEnabled(!1),Me.position=new l.s(0,27,0);var ye,be,xe=l.k.CreateCylinder("moveArea",{height:.25,diameter:227.25,tessellation:256},e);xe.material=C,xe.parent=Me,l.n.ImportMesh("","./Models/","setting.babylon",e,(function(n){(ye=n[0]).scaling=new l.s(1150,1200,1e3),ye.material=g,o.getShadowMap().renderList.push(ye),(be=l.k.CreateBox("map",{width:808,height:606,depth:1},e)).rotate(l.d.X,l.r.ToRadians(90),e),be.material=f,be.receiveShadows=!0,be.translate(l.d.Y,25,e),be.actionManager=G}));var ke=function(){"teamWhite"===N.team?(N.team="teamBlack",t.position=new l.s(-700,300,0),Re()):"teamBlack"===N.team&&(N.team="teamWhite",t.position=new l.s(700,300,0),Re()),q()},Ce="",Ee=!1,Te={position:null,rotation:null},Se=function(n){if(1===n.sourceEvent.which){var t=n.meshUnderPointer;e.hoverCursor="pointer",Ce===t?Ge({skip:!0}):t.id.includes("Mini")&&(Ce&&a.removeMesh(Ce),N.turnActions>0&&(a.addMesh(t,l.f.White()),a.addMesh(Me,l.f.White()),Ce=t,Te.position=Ce.position,Me.position=new l.s(t.position.x,t.position.y+2,t.position.z),Me.setEnabled(!0)))}},Oe=function(){Ce&&Ee?Te.position&&(Ce.position=Te.position,Ce.rotation=Te.rotation,Me.setEnabled(!0),Me.position=new l.s(Te.position.x,Te.position.y+2,Te.position.z),Ce._children[1].setEnabled(!1),n.removeEventListener("mousemove",De),Ee=!1):Ce&&!Ee&&(Me.setEnabled(!1),a.removeMesh(Ce),a.removeMesh(Me),e.removeMesh(de),Ce._children[1].setEnabled(!1),Re(),Ce="",e.hoverCursor="pointer",de&&de.dispose())},ze=function(n,t){var i=new l.s(n.position.x,n.position.y+.75*ge(n),n.position.z),o=new l.s(t.position.x,t.position.y+.75*ge(t),t.position.z-t.width/2+.25*t.width),a=new l.s(t.position.x,t.position.y+.75*ge(t),t.position.z+t.width/2-.25*t.width),s=o.subtract(i);s=l.s.Normalize(s);var r=a.subtract(i);r=l.s.Normalize(r);var c=l.s.Distance(n.position,t.position)-fe(t)/2,u=new l.m(i,s,c),m=new l.m(i,r,c),d=e.multiPickWithRay(u),p=e.multiPickWithRay(m);return!d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||!p.some((function(e){return e.pickedMesh.name.includes("obstacle")}))},We=function(n,t){var i=new l.s(n.position.x,n.position.y+5,n.position.z-n.width/2+.25*n.width),o=new l.s(n.position.x,n.position.y+5,n.position.z+n.width/2-.25*n.width),a=new l.s(t.position.x,t.position.y+5,t.position.z),s=a.subtract(i);s=l.s.Normalize(s);var r=a.subtract(o);r=l.s.Normalize(r);var c=n.width/2+n.width,u=new l.m(i,s,c),m=new l.m(o,r,c),d=e.multiPickWithRay(u),p=e.multiPickWithRay(m);return d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||p.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?(console.log(n.name+" is in cover!"),!0):(console.log(n.name+" is NOT in cover!"),!1)},_e=function(e,n){var t=Ye(e),i=new l.s(e.position.x,55,e.position.z),o=new l.s(n.position.x,55,n.position.z).subtract(i);return o=l.s.Normalize(o),!(180*Math.acos(l.s.Dot(t,o))/Math.PI>90)},Ae=function(e){var n=e.meshUnderPointer;Ce&&ze(Ce,n)&&(n.intersectsMesh(Ce,!1)||(Ie(Ce,n)?(Ce._children[1].setEnabled(!0),Me.setEnabled(!1)):n.intersectsMesh(Ce,!1)||Ie(Ce,n)||(Me.setEnabled(!1),Ce._children[1].setEnabled(!0))))},Be=function(){Ce&&(Ce._children[1].setEnabled(!1),Ee||Me.setEnabled(!0)),e.hoverCursor="pointer"},Re=function(){if(I[N.team].minis){var n=I[N.team].minis.map((function(e){return e.position.x})),i="teamWhite"===N.team?n.indexOf(Math.min.apply(Math,Object(r.a)(n))):n.indexOf(Math.max.apply(Math,Object(r.a)(n))),o=I[N.team].minis[i],a=l.j.CreateSphere("targetSphere",{size:10},e);a.visibility=0,a.position=new l.s(o.position.x,o.position.y,0),t.setTarget(a),setTimeout((function(){a.dispose()}),1100)}},Pe=function(e,n,t,i){for(var o=[],a=0;a<e;a++)o.push(Math.floor(6*Math.random())+1);return o},Le=function(n,t,i){for(var o=new l.s(t.position.x+10,t.position.y+7,t.position.z+30),a=new l.s(t.position.x+10,t.position.y+7,t.position.z+45),s=new l.s(t.position.x+-5,t.position.y+7,t.position.z+30),r=new l.s(t.position.x+-5,t.position.y+7,t.position.z+37.5),c=new l.s(t.position.x+-5,t.position.y+7,t.position.z+45),u=new l.s(t.position.x+-20,t.position.y+7,t.position.z+30),m=new l.s(t.position.x+-20,t.position.y+7,t.position.z+37.5),d=[o,a,s,c,u,new l.s(t.position.x+-20,t.position.y+7,t.position.z+45)],p=function(o){g=o+1,t.name.includes("white")?Z[n[o]-1].material=x:Z[n[o]-1].material=k,3===n.length&&3===g?Z[n[o]-1].clone("diceClone".concat(o)).position=r:5===n.length&&5===g?Z[n[o]-1].clone("diceClone".concat(o)).position=m:Z[n[o]-1].clone("diceClone".concat(o)).position=d[o],setTimeout((function(){e.removeMesh(e.getMeshByName("diceClone".concat(o)))}),i)},h=0;h<n.length;h++){var g;p(h)}},je=function(e,n,t,i){var o=e.filter((function(e){return e+n>=N.army.units.soldier.range.success})),a=t.filter((function(e){return e+i>=X.army.units.soldier.range.success}));console.log("Player rolls:"),console.log(e),console.log("He has a "+n+" modifier to dice roll"),console.log("Enemy rolls:"),console.log(t),console.log("He has a "+i+" modifier to dice roll"),console.log("Player success rolls:"),console.log(o),console.log("Enemy Success rolls:"),console.log(a);for(var s=0;s<o.length;s++)for(var l=0;l<a.length;l++)o[s]===a[l]&&(o.splice(s,1),a.splice(l,1));return Math.max.apply(Math,Object(r.a)(o))>Math.max.apply(Math,Object(r.a)(a))?(console.log("Player wins with a higher roll!"),"player"):Math.max.apply(Math,Object(r.a)(a))>Math.max.apply(Math,Object(r.a)(o))?(console.log("Enemy wins with a higher roll!"),"enemy"):null},Ie=function(e,n){var t,i=l.s.Distance(e.position,n.position)-n.width/2,o="whiteMini"===e.name?"teamWhite":"teamBlack",a=I[o].armyStats.units[e.unit].maxRange;return i<=e.width/2+n.width/2?t="c":i<=202?t="s":i>202&&i<=404?t="m":i>404&&i<=808?t="l":i>808&&i<=a?t="xl":i>a&&(t=null),ze(e,n)&&_e(e,n)?t:null},Ne=function(){var e="";return 0===I.teamBlack.startActions&&0===I.teamWhite.startActions?(console.log("tie"),e=null,console.log("Game Over. No Winners this time.")):0===I.teamBlack.startActions?(e="Team White",console.log("Game Over. ".concat(e," wins!"))):0===I.teamWhite.startActions?(e="Team Black",console.log("Game Over. ".concat(e," wins!"))):e=void 0,e},Xe=function(n){var i=n.meshUnderPointer,o="";if(Ce){var a=Ce,s=Ie(Ce,i),r=We(Ce,i)?1:0,c=r+N.army.units[Ce.unit].range.mods[s],u=We(i,Ce)?1:0,m=u+X.army.units[i.unit].range.mods[s];if(s&&_e(Ce,i)){if(i.intersectsMesh(Ce,!1)||"c"===s){console.log("Stabbing "+i.id+" with "+Ce.id),console.log("Player target roll: "+N.army.units[Ce.unit].melee.success+"+");var d=Pe(N.army.units[Ce.unit].melee.roll);Le(d,Ce,1e3),console.log("Enemy target roll: "+X.army.units[Ce.unit].melee.success+"+");var p=Pe(1);Le(p,i,1e3),o=je(d,0,p,0)}else{var h=[],g=[],f=[];console.log("Shooting ".concat(i.id," with ").concat(Ce.id," at range ").concat(s,".")),console.log("Player target roll: "+N.army.units[Ce.unit].range.success+"+"),h=Pe(N.army.units[Ce.unit].range.roll),Le(h,Ce,1e3),g=h.map((function(e){return e+c})),Ie(i,Ce)&&(console.log("Enemy target roll: "+X.army.units[i.unit].range.success+"+"),f=Pe(1),Le(f,i,1e3),o=je(h,c,f,m)),o||g.some((function(e){return e>=N.army.units[Ce.unit].range.success}))&&(console.log("Success! You shot him!"),o="player")}if("player"===o){console.log("Enemy is hit. Defense roll target: "+X.army.units[i.unit].defense.success+"+"),u>0&&console.log("Enemy has +1 to dice roll as he is in cover.");var w=Pe(X.army.units[i.unit].defense.roll);console.log("Enemy rolls : "),console.log(w),setTimeout((function(){Le(w,i,1250)}),1250),w.some((function(e){return e+u>=X.army.units[i.unit].defense.success}))?console.log("Defense roll successful. Enemy saved!"):(console.log("Enemy killed!"),setTimeout((function(){i.position=new l.s(Math.floor(190*Math.random())-200,0,-440+Math.floor(30*Math.random())-15),i.name="decor",i.isPickable=!1,I[X.team].minis=I[X.team].minis.filter((function(e){return e.id!==i.id})),I[X.team].startActions-=2,Ne(),Oe()}),2500))}else if("enemy"===o){console.log("Player is hit. Defense roll target: "+N.army.units[Ce.unit].defense.success+"+"),r>0&&console.log("Player has +1 to dice roll as he is in cover.");var v=Pe(N.army.units[Ce.unit].defense.roll);console.log("Player rolls : "),console.log(v),setTimeout((function(){Le(v,a,1250)}),1250),v.some((function(e){return e+r>=N.army.units[Ce.unit].defense.success}))?console.log("Defense roll successful. Player mini saved!"):(console.log("Player killed!"),setTimeout((function(){t.target=be,a.position=new l.s(200-Math.floor(190*Math.random()),0,-440+Math.floor(30*Math.random())-15),a.name="decor",a.isPickable=!1,I[N.team].minis=I[N.team].minis.filter((function(e){return e.id!==a.id})),I[N.team].startActions-=2,Ne(),Oe()}),2500))}else console.log("No winners! Try again.");I[N.team].turnActions-=1,e.removeMesh(e.getMeshByName("token")),Oe(),0===I[N.team].turnActions&&setTimeout((function(){ke()}),3e3)}}},Ge=function(e){var n=e.skip;Ce&&(n||(Te.position=Ce.position,Ce.position=de.position),Me.position=new l.s(Ce.position.x,Ce.position.y+2,Ce.position.z),Me.setEnabled(!1),Ce._children[1].setEnabled(!0),Te.rotation=Ce.rotation.clone(),Ee=!0)},Ye=function(e){var n=new l.s(0,0,-1),t=e.getDirection(n);return t.normalize(),t},De=function(e){if(e.preventDefault(),Ce&&Ze(e)){var n=Ce.position.x-Ze(e).x,t=Ce.position.z-Ze(e).z;Ce.rotation.y=Math.atan2(n,t)}},Fe=function(n){1!==n.which&&1!==n.sourceEvent.which||Ce&&Ee&&(I[N.team].turnActions-=1,e.removeMesh(e.getMeshByName("token")),Ee=!1,Te.position=null,Te.rotation=null,Oe(),0===I[N.team].turnActions&&setTimeout((function(){ke()}),1e3))},qe=function(e){if((e.preventDefault(),Ce&&Ze(e))&&(![].concat(Object(r.a)(I[X.team].minis),Object(r.a)(I[N.team].minis.filter((function(e){return e.id!==Ce.id})))).some((function(n){return Ze(e).x<n.position.x+fe(n)-2&&Ze(e).x>n.position.x-fe(n)+2&&Ze(e).z<n.position.z+fe(n)-2&&Ze(e).z>n.position.z-fe(n)+2}))&&!ve.filter((function(e){return ge(e)+e.position.y-ge(e)/2>ge(Ce)+Ce.position.y})).some((function(n){return Ze(e).x<n.position.x+fe(n)/2+fe(Ce)/2&&Ze(e).x>n.position.x-fe(n)/2-fe(Ce)/2&&Ze(e).z<n.position.z+we(n)/2+fe(Ce)/2&&Ze(e).z>n.position.z-we(n)/2-fe(Ce)/2}))&&Ze(e).x>-388&&Ze(e).x<388&&Ze(e).z>-285&&Ze(e).z<285)){var n=ve.filter((function(e){return ge(e)<ge(Ce)+Ce.position.y-25})).filter((function(n){return Ze(e).x<n.position.x+fe(n)/2+fe(Ce)/2&&Ze(e).x>n.position.x-fe(n)/2-fe(Ce)/2&&Ze(e).z<n.position.z+we(n)/2+fe(Ce)/2&&Ze(e).z>n.position.z-we(n)/2-fe(Ce)/2}));n&&n.length>0?de.position=new l.s(Ze(e).x,ge(n[0])+26,Ze(e).z):de.position=new l.s(Ze(e).x,25,Ze(e).z)}},Ze=function(){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e===be}));return n.hit?n.pickedPoint:null};Y.registerAction(new l.g(l.a.OnPointerOverTrigger,(function(e){(de=Ce.clone()).position=Ce.position,de.isPickable=!1,de._children[1].setEnabled(!1),le.setEnabled(!1),de.material=c,n.addEventListener("mousemove",qe,!1),n.addEventListener("click",Ge,!1)}))),Y.registerAction(new l.g(l.a.OnPointerOutTrigger,(function(e){de.dispose(),n.removeEventListener("mousemove",qe),n.removeEventListener("click",Ge)}))),G.registerAction(new l.g(l.a.OnPointerOverTrigger,(function(e){Ce&&Ee&&Ce._children[1].setEnabled(!0),Ee&&(n.addEventListener("mousemove",De,!1),n.addEventListener("click",Fe,!1))}))),G.registerAction(new l.g(l.a.OnPointerOutTrigger,(function(e){Ce&&!Ee&&Ce._children[1].setEnabled(!1),n.removeEventListener("mousemove",De),n.removeEventListener("click",Fe)}))),D.registerAction(new l.g(l.a.OnPickUpTrigger,(function(e){"teamBlack"===N.team&&(Ee?Fe(e):Se(e))}))),D.registerAction(new l.g(l.a.OnLeftPickTrigger,(function(e){"teamWhite"!==N.team||Ee||Xe(e)}))),D.registerAction(new l.g(l.a.OnPointerOverTrigger,(function(e){"teamWhite"===N.team&&Ae(e)}))),D.registerAction(new l.g(l.a.OnPointerOutTrigger,(function(e){"teamWhite"===N.team&&Be()}))),F.registerAction(new l.g(l.a.OnPickUpTrigger,(function(e){"teamWhite"===N.team&&(Ee?Fe(e):Se(e))}))),F.registerAction(new l.g(l.a.OnLeftPickTrigger,(function(e){"teamBlack"!==N.team||Ee||Xe(e)}))),F.registerAction(new l.g(l.a.OnPointerOverTrigger,(function(e){"teamBlack"===N.team&&Ae(e)}))),F.registerAction(new l.g(l.a.OnPointerOutTrigger,(function(e){"teamBlack"===N.team&&Be()}))),n.addEventListener("contextmenu",Oe,!1),e.onDispose=function(){n.removeEventListener("mousemove",qe),n.removeEventListener("contextmenu",Oe)}},g=function(){return o.a.createElement("div",null,o.a.createElement(d,{className:"w-full h-full",antialias:!0,onSceneReady:h,id:"my-canvas"}))},f=function(){return o.a.createElement("div",{className:"w-full h-full"},o.a.createElement(g,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[160,1,2]]]);
//# sourceMappingURL=main.8ee03f08.chunk.js.map