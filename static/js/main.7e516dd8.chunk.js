(this["webpackJsonpinsys-game"]=this["webpackJsonpinsys-game"]||[]).push([[0],{179:function(e,t,n){e.exports=n(193)},184:function(e,t,n){},185:function(e,t,n){},192:function(e,t,n){},193:function(e,t,n){"use strict";n.r(t);var a=n(15),i=n.n(a),o=n(170),s=n.n(o),r=(n(184),n(185),n(194)),c=n(36),l=(n(187),n(100)),m=n.n(l),u=n(127),d={tabForces:{units:{STLRW:{name:"Steeler bot",image:"https://images.hive.blog/DQmVhaUTAscBfhxCJoUDYhi7SXhyJjaa8vmPS6up2Car12c/STLRW.png",army:"T.A.B. Forces",class:"Light",color:"green",specials:"N/A",equipment:{range:"Laser gun",melee:"Wakizashi"},move:4,defense:{roll:1,success:4},melee:{roll:1,success:3},range:{roll:1,success:3,mods:{s:-1,m:1,l:0,xl:-1}},maxRange:1212,maxInGame:void 0,cost:3}}},sysTroops:{units:{WBORK:{name:"Whiteboot troop",army:"SYS Troops",class:"Light",color:"blue",specials:"N/A",equipment:{range:"Assault rifle",melee:"Knife"},move:4,defense:{roll:1,success:4},melee:{roll:1,success:4},range:{roll:2,success:4,mods:{s:0,m:1,l:-1,xl:-1}},maxRange:1212,maxInGame:void 0,cost:3}}},rebels:{units:{OTTMK:{name:"Otto rebel",image:"https://images.hive.blog/DQmRhgeaJftN7dH85hYdgQ49ySdFt5WD2XLErmxyHm2wLXF/OTTMK.png",army:"Raging Rebels",class:"Light",color:"orange",specials:"N/A",equipment:{range:"Machine gun",melee:"Hatchet"},move:4,defense:{roll:1,success:4},melee:{roll:2,success:4},range:{roll:3,success:5,mods:{s:1,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:3}}},outerRing:{units:{SKNCK:{name:"Skinner savage",image:"https://images.hive.blog/DQmeB4P34AG9BdNd7SjmEvjiqNk6Et93bcJtNrViH6eiwEC/SKN.png",army:"Outer-Ring Savages",class:"Light",color:"yellow",specials:"N/A",equipment:{range:"Crossbow",melee:"Kukri"},move:4,defense:{roll:1,success:4},melee:{roll:2,success:3},range:{roll:1,success:3,mods:{s:1,m:0,l:-2,xl:-2}},maxRange:1212,maxInGame:void 0,cost:3}}},voidWarriors:{units:{BACRC:{name:"Bac warrior",army:"Void Warriors",class:"Light unit",color:"purple",specials:"N/A",equipment:{range:"Assault rifle",melee:"Chainsaw attachment"},move:4,defense:{roll:1,success:4},melee:{roll:4,success:5},range:{roll:3,success:5,mods:{s:0,m:0,l:-1,xl:-2}},maxRange:1212,maxInGame:void 0,cost:3}}}},f=i.a.createContext(),g=new(n(191).Client)({app:"insys-game",callbackURL:"http://localhost:3000/insys-game",accessToken:"access_token",scope:["vote","posting"]});function h(e){var t=e.children,n=Object(r.a)((function(){return{canvasHeight:400,userDetail:{},loginLink:"",fullScreen:!1,generateTableNumber:function(){return Math.floor(Math.random()*Math.floor(Math.random()*Date.now()))},setTimer:function(){setInterval((function(){n.gameInfo.players[n.gameInfo.currentPlayer.team].timeLeft-=1}),1e3)},setCanvasHeight:function(e){n.canvasHeight=e},toggleFullScreen:function(){n.fullScreen=!n.fullScreen},gameInfo:{get tableNumber(){return n.generateTableNumber()},currentPlayer:{get name(){return n.gameInfo.players[this.team].name},team:"teamWhite"},history:[],players:{teamWhite:{name:"Jrej",army:"rebels",get armyStats(){return d[this.army]},units:["OTTMK","OTTMK","OTTMK"],minis:[],startActions:6,turnActions:6,timeLeft:1500},teamBlack:{name:"Inkito",army:"tabForces",get armyStats(){return d[this.army]},units:["STLRW","STLRW","STLRW"],minis:[],startActions:6,turnActions:6,timeLeft:1500}}},gameUpdate:{setCurrentPlayer:function(e){n.gameInfo.currentPlayer=e},log:function(e){n.gameInfo.history.push(e)},addImportedMini:function(e,t){n.gameInfo.players[t].minis.push(e)},removeTurnAction:function(e){n.gameInfo.players[e].turnActions-=1},resetTurnActions:function(e){n.gameInfo.players[e].turnActions=n.gameInfo.players[e].startActions},removePlayerMini:function(e,t){n.gameInfo.players[t].minis=n.gameInfo.players[t].minis.filter((function(t){return t.id!==e})),n.gameInfo.players[t].startActions-=2}},temporalLogin:function(){var e=Object(u.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:"jrej",app:"inkito"})},e.next=3,fetch("https://inkito-ipfs.herokuapp.com/login",t).then((function(e){return e.text()}));case 3:a=e.sent,Object(c.runInAction)((function(){n.ipfsState="success"===a}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),logOut:function(){return g.revokeToken((function(e,t){t&&t.success&&(n.userDetail={},document.location.href="/"),localStorage.setItem("access-token",""),localStorage.setItem("users",""),n.userDetail={},e&&console.log(e)})),!1},initHSLogin:function(){var e=g.getLoginURL();Object(c.runInAction)((function(){n.loginLink=e}))},login:function(e){var t={username:e};g.login(t,(function(t,a){a?n.getUserDetail(a,e):t&&console.log(t)}))},getUserDetail:function(e,t){if(n.userDetail={},e&&t)var a=e,i=t;else a=new URLSearchParams(document.location.search).get("access_token"),i=new URLSearchParams(document.location.search).get("username");a&&(g.setAccessToken(a),g.me((function(e,t){t&&Object(c.runInAction)((function(){n.userDetail=t,a&&localStorage.setItem("access-token",JSON.stringify(a)),i&&localStorage.setItem("users",JSON.stringify(i))})),e&&console.log(e)})))}}}));return i.a.createElement(f.Provider,{value:n},t)}var p=f,v=(n(192),n(109)),y=n(12),w=n(171),b=n(161),M=n(97),x=n(134),E=n(178),k=function(e){var t=i.a.useContext(p),n=Object(a.useRef)(null),o=(e.antialias,e.engineOptions,e.adaptToDeviceRatio,e.sceneOptions),s=e.onRender,r=(e.onSceneReady,Object(E.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady"])),c=Object(a.useState)(!1),l=Object(x.a)(c,2),m=l[0],u=l[1],d=Object(a.useState)(null),f=Object(x.a)(d,2),g=f[0],h=f[1];return Object(a.useEffect)((function(){if(window){var e=function(){g&&g.getEngine().resize()};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[g]),Object(a.useEffect)((function(){if(!m){u(!0);var a=new y.h(n.current,!0,{stencil:!0}),i=new y.p(a,o);h(i),i.isReady()?e.onSceneReady(i,t.gameInfo.players,t.gameUpdate):i.onReadyObservable.addOnce((function(n){return e.onSceneReady(n,t.gameInfo.players,t.gameUpdate)})),a.runRenderLoop((function(){"function"===typeof s&&s(i),i.render()}))}return n.current.onwheel=function(e){e.preventDefault()},n.current.onmousewheel=function(e){e.preventDefault()},t.setCanvasHeight(n.current.height),function(){null!==g&&g.dispose()}}),[m,o,e,s,g,t,t.gameInfo.players,t.gameUpdate]),i.a.createElement("canvas",Object.assign({id:"canvas",tabIndex:"1",ref:n},r))};y.b.AllowMatricesInterpolation=!0;var N=function(e,t,n){var a=e.getEngine().getRenderingCanvas(),i=b.a.CreateFullscreenUI("sceneUI");i.isForeground=!0;var o=new y.c("arcCamera",y.u.ToRadians(0),y.u.ToRadians(100),780,new y.v(-60,400,0),e);o.attachControl(a,!0),o.angularsensibility*=-1,o.checkCollisions=!0,o.ellipsoid=new y.v(1.5,1,1.5);var s=new y.n("pointLight",new y.v(75,400,150),e);s.intensity=1,s.range=5e3,new y.j("hemiLight",new y.v(0,-4900,0),e).intensity=.7;var r=new y.r(1024,s);r.usePoissonSampling=!0;var c=new y.k("hl1",e);c.innerGlow=!1;var l=new y.s("invisibleMaterial",e);l.alpha=0;var d=new y.s("transparentMaterial",e);d.alpha=.5;var f=y.m.CreateSphere("skyBox",{diameter:5500,diameterX:5500},e),g=new y.s("skyBox",e);g.backFaceCulling=!1,f.material=g,f.receiveShadows=!0;var h=y.m.CreateCylinder("background",{height:1,diameter:5e3,tessellation:5e3},e),p=new y.s("background",e);p.opacityTexture=new y.t(".".concat("","/Textures/OpacityTemplate.png"),e),p.backFaceCulling=!1,h.material=p,h.translate(y.d.Y,-1,e),h.visibility=.4,h.receiveShadows=!0;var x=new y.s("boardMaterial",e);x.diffuseTexture=new y.t(".".concat("","/Textures/Wood/Wood_021_basecolor.jpg"),e),x.bumpTexture=new y.t(".".concat("","/Textures/Wood/Wood_021_normal.jpg"),e),x.ambientTexture=new y.t(".".concat("","/Textures/Wood/Wood_021_ambientOcclusion.jpg"),e);var E=new y.s("asphaltMaterial",e);E.diffuseTexture=new y.t(".".concat("","/Textures/Asphalt/Asphalt_001_COLOR.jpg"),e),E.bumpTexture=new y.t(".".concat("","/Textures/Asphalt/Asphalt_001_NRM.jpg"),e),E.specularTexture=new y.t(".".concat("","/Textures/Asphalt/Asphalt_001_SPEC.jpg"),e),E.ambientTexture=new y.t(".".concat("","/Textures/Asphalt/Asphalt_001_OCC.jpg"),e);var k=new y.s("plasticMaterial",e);k.diffuseColor=new y.f(220/255,220/255,220/255);var N=new y.s("tokenMaterial",e);N.diffuseTexture=new y.t(".".concat("","/Textures/Token/Coin_low_Coin_material_BaseColor2.png"),e),N.bumpTexture=new y.t(".".concat("","/Textures/Token/Coin_low_Coin_material_Normal.png"),e);var S=new y.s("tokenMaterial",e);S.diffuseTexture=new y.t(".".concat("","/Textures/Token/Coin_low_Coin_material_BaseColor.png"),e),S.bumpTexture=new y.t(".".concat("","/Textures/Token/Coin_low_Coin_material_Normal.png"),e),new y.s("baseMaterial",e).diffuseColor=new y.f.Black,new y.s("baseMaterial",e).diffuseColor=new y.f.White;var O=new y.s("diceMatWhite",e);O.diffuseColor=new y.f.White;var B=new y.s("diceMatBlack",e);B.diffuseColor=new y.f.Black;var C=new y.s("diceMatRed",e);C.diffuseColor=new y.f(164/255,27/255,7/255);var T="if( vPositionW.z  < -340.){ discard; } if( vPositionW.z  > 340.){ discard; } if( vPositionW.x  > 450.){ discard; } if( vPositionW.x  < -450.){ discard; }",L=new M.a("moveAreaMat",e);L.alpha=.25,L.Fragment_Custom_Diffuse(T);var A=new M.a("losMatSW",e);A.alpha=.25,A.Fragment_Custom_Diffuse(T);var j=new M.a("losMatMW",e);j.alpha=.25,j.Fragment_Custom_Diffuse(T);var I=new M.a("losMatLW",e);I.alpha=.25,I.Fragment_Custom_Diffuse(T);var z=new M.a("losMatXLW",e);z.alpha=.25,z.Fragment_Custom_Diffuse(T);var W=new M.a("losMatSB",e);W.alpha=.25,W.Fragment_Custom_Diffuse(T);var R=new M.a("losMatMB",e);R.alpha=.25,R.Fragment_Custom_Diffuse(T);var P=new M.a("losMatLB",e);P.alpha=.25,P.Fragment_Custom_Diffuse(T);var _=new M.a("losMatXLB",e);_.alpha=.25,_.Fragment_Custom_Diffuse(T);var D,F,J,U,q,H,Y,G={team:"teamWhite",get name(){return t[this.team].name},get army(){return t[this.team].armyStats},get startActions(){return t[this.team].startActions},get turnActions(){return t[this.team].turnActions}},X={get team(){return"teamWhite"===G.team?"teamBlack":"teamWhite"},get name(){return t["teamWhite"===G.team?"teamBlack":"teamWhite"].name},get army(){return t["teamWhite"===G.team?"teamBlack":"teamWhite"].armyStats}},K=new y.a(e),V=new y.a(e),Z=new y.a(e),Q=new y.a(e),$=function(){y.q.ImportMesh("",".".concat("","/Models/"),"token.babylon",e,(function(e){(D=y.l.MergeMeshes(e)).position=new y.v(150,-18,440),D.scaling=new y.v(800,900,800),D.name="token",D.id="token1",D.material="teamWhite"===G.team?S:N;for(var t,a=D.position.x,i=G.startActions-1,o=0;o<i;o++){(t=D.clone("token".concat(o+2))).name="token";var s=Math.floor(40*Math.random())+50;t.position.x=a-s,t.position.z=D.position.z+Math.floor(30*Math.random())-15,a-=s}n.resetTurnActions(G.team)}))};$();var ee=[];y.q.ImportMesh("",".".concat("","/Models/"),"dice.babylon",e,(function(t){(F=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),F.translate(y.d.Y,30,e),F.translate(y.d.X,175,e),F.translate(y.d.Z,50,e),r.getShadowMap().renderList.push(F),F.id="dice1",F.name="dice",F.checkCollisions=!0,F.collisionGroup=1,F.collisionMask=1,F.setEnabled(!1),ee.push(F)})),y.q.ImportMesh("",".".concat("","/Models/"),"dice2.babylon",e,(function(t){(J=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),J.rotation.y=y.u.ToRadians(90),J.rotation.x=y.u.ToRadians(90),J.translate(y.d.Y,33,e),J.translate(y.d.X,175,e),J.translate(y.d.Z,50,e),r.getShadowMap().renderList.push(J),J.id="dice2",J.name="dice",J.checkCollisions=!0,J.collisionGroup=1,J.collisionMask=1,J.setEnabled(!1),ee.push(J)})),y.q.ImportMesh("",".".concat("","/Models/"),"dice3.babylon",e,(function(t){(U=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),U.translate(y.d.Y,33,e),U.translate(y.d.X,175,e),U.translate(y.d.Z,50,e),r.getShadowMap().renderList.push(U),U.id="dice3",U.name="dice",U.checkCollisions=!0,U.collisionGroup=1,U.collisionMask=1,U.setEnabled(!1),ee.push(U)})),y.q.ImportMesh("",".".concat("","/Models/"),"dice4.babylon",e,(function(t){(q=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),q.translate(y.d.Y,33,e),q.translate(y.d.X,175,e),q.translate(y.d.Z,50,e),r.getShadowMap().renderList.push(q),q.id="dice4",q.name="dice",q.checkCollisions=!0,q.collisionGroup=1,q.collisionMask=1,q.setEnabled(!1),ee.push(q)})),y.q.ImportMesh("",".".concat("","/Models/"),"dice5.babylon",e,(function(t){(H=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),H.rotation.x=y.u.ToRadians(180),H.translate(y.d.Y,33,e),H.translate(y.d.X,175,e),H.translate(y.d.Z,50,e),r.getShadowMap().renderList.push(H),H.id="dice5",H.name="dice",H.checkCollisions=!0,H.collisionGroup=1,H.collisionMask=1,H.setEnabled(!1),ee.push(H)})),y.q.ImportMesh("",".".concat("","/Models/"),"dice6.babylon",e,(function(t){(Y=y.l.MergeMeshes(t)).scaling=new y.v(20,20,20),Y.translate(y.d.Y,33,e),Y.translate(y.d.X,175,e),Y.translate(y.d.Z,50,e),Y.rotate(y.d.Y,y.u.ToRadians(90),e),r.getShadowMap().renderList.push(Y),Y.id="dice6",Y.name="dice",Y.checkCollisions=!0,Y.collisionGroup=1,Y.collisionMask=1,Y.setEnabled(!1),ee.push(Y)}));var te=y.m.CreateCylinder("lineOfSights",{height:.1,diameter:429.25,tessellation:256},e);te.position=new y.v(0,-100,0);var ne=y.m.CreateCylinder("lineOfSightm",{height:.1,diameter:833.25,tessellation:256},e),ae=y.m.CreateCylinder("lineOfSightl",{height:.1,diameter:1641.25,tessellation:256},e);ae.parent=ne.parent=te;var ie=y.e.FromMesh(te),oe=y.e.FromMesh(ne),se=y.e.FromMesh(ae),re=y.m.CreateBox("LOSTemplate",{width:2424,height:2500,depth:1},e);re.rotate(y.d.X,y.u.ToRadians(90),e),re.position=new y.v(1212,-100,0),re.visibility=0;var ce=y.e.FromMesh(re);se=se.subtract(ce).subtract(oe).subtract(ie),oe=oe.subtract(ce).subtract(ie);var le=(ie=ie.subtract(ce)).toMesh("lineOfSightS"),me=oe.toMesh("lineOfSightM"),ue=se.toMesh("lineOfSightL");ue.parent=me.parent=le,ue.isPickable=me.isPickable=le.isPickable=!1,le.setEnabled(!1),re.dispose(),te.dispose(),ne.dispose(),ae.dispose();var de,fe=function(e,n,a){var i=new y.f(164/255,27/255,7/255),o=new y.f(215/255,195/255,58/255),s=new y.f(7/255,66/255,164/255),r=new y.f(7/255,164/255,27/255);return t[n].armyStats.units[e].range.mods[a]>0?r:0===t[n].armyStats.units[e].range.mods[a]?s:-1===t[n].armyStats.units[e].range.mods[a]?o:t[n].armyStats.units[e].range.mods[a]<=-2?i:void 0},ge=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.y*e.scaling.y},he=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.x*e.scaling.x},pe=function(e){return 2*e.getBoundingInfo().boundingBox.extendSize.z*e.scaling.z},ve=function(e){return i._rootContainer._children.filter((function(t){return t.name===e}))[0]};function ye(e,t){return we.apply(this,arguments)}function we(){return(we=Object(u.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<t.length)){e.next=7;break}return e.next=4,n(t[a],a,t);case 4:a++,e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}y.q.ImportMesh("",".".concat("","/Models/"),"shield.babylon",e,(function(t){(de=y.l.MergeMeshes(t)).scaling=new y.v(6,5,10),de.translate(y.d.Y,80,e),r.getShadowMap().renderList.push(de),de.id="shield",de.name="shield",de.setEnabled(!1)}));var be,Me=function(){if(t[G.team].minis&&t[G.team].minis.length>0){var n=t[G.team].minis.map((function(e){return e.position.x})),a="teamWhite"===G.team?n.indexOf(Math.min.apply(Math,Object(v.a)(n))):n.indexOf(Math.max.apply(Math,Object(v.a)(n))),i=t[G.team].minis[a],s=y.l.CreateSphere("targetSphere",{size:10},e);s.setEnabled(!1),s.position=new y.v(i.position.x,i.position.y+30,0),o.setTarget(s),setTimeout((function(){s.dispose()}),1100)}},xe=function(a,i,o){y.q.ImportMesh("",".".concat("","/Models/"),"".concat(a,".babylon"),e,(function(s){var c=y.l.MergeMeshes(s);c.translate(y.d.Y,25,e),c.translate(y.d.X,"Black"===i?-300:300,e),c.translate(y.d.Z,200*o-200,e),c.id="".concat(i.toLowerCase(),"Mini").concat(o+1),c.unit=a,c.team="team".concat(i),c.class=t[c.team].armyStats.units[a].class,c.name=t[c.team].armyStats.units[a].name,c.rotation.y="Black"===i?y.u.ToRadians(-90):y.u.ToRadians(90),c.material=k,c.actionManager="Black"===i?Z:Q,c.enablePointerMoveEvents=!0,c.width=he(c),c.height=ge(c),function(t,n){var a=y.m.CreateCylinder("".concat(t.id,"Base"),{height:2.5,diameter:27,tessellation:128},e);a.material=new y.s("baseMaterial".concat(t.id),e),a.material.diffuseColor="Black"===n?new y.f.Black:new y.f.White,a.position=new y.v(0,1.5,0),a.parent=t}(c,i),function(e,t){var n=le.clone();n.id="".concat(e.id,"lineOfSight"),n.name="".concat(e.id,"lineOfSight"),n.parent=e,n.position=new y.v(0,1,0),n.rotation.y=y.u.ToRadians(-90),n.setEnabled(!1),n.material="Black"===t?W:A,n._children[0].material="Black"===t?R:j,n._children[1].material="Black"===t?P:I,"Black"===t?(e.losMat=[W.name,R.name,P.name,_.name],W.diffuseColor=fe(e.unit,"team".concat(t),"s"),R.diffuseColor=fe(e.unit,"team".concat(t),"m"),P.diffuseColor=fe(e.unit,"team".concat(t),"l")):(e.losMat=[A.name,j.name,I.name,z.name],A.diffuseColor=fe(e.unit,"team".concat(t),"s"),j.diffuseColor=fe(e.unit,"team".concat(t),"m"),I.diffuseColor=fe(e.unit,"team".concat(t),"l"))}(c,i),function(t,n){var a=de.clone("".concat(t.id,"shield"));a.material=new y.s("shieldMaterial".concat(t.id),e),a.material.diffuseColor="Black"===n?new y.f.Black:new y.f.White,a.parent=t,a.position=new y.v(0,55,0),a.setEnabled(!1)}(c,i),r.getShadowMap().renderList.push(c),n.addImportedMini(c,"team".concat(i)),t.teamWhite.minis&&t.teamWhite.minis.length===t.teamWhite.units.length&&Me()}))};t.teamBlack.units.forEach((function(e,t){return xe(e,"Black",t)})),t.teamWhite.units.forEach((function(e,t){return xe(e,"White",t)}));var Ee=[];y.q.ImportMesh("",".".concat("","/Models/"),"container.babylon",e,(function(t){var n=y.l.MergeMeshes(t);n.scaling=new y.v(2,2,2),n.id="obstacle1",n.name="obstacle",n.receiveShadows=!0,n.width=he(n),n.length=pe(n),n.height=ge(n);var a=new y.s(e);a.diffuseColor=new y.f(.518,.271,.267);var i=new y.s(e);i.diffuseColor=new y.f(.671,.663,.733);var o=new y.s(e);o.diffuseColor=new y.f(.318,.502,.43);var s=n.clone("obstacle");s.position=new y.v(22,0,2.5);var c=n.clone("obstacle");c.position=new y.v(-22,0,2.5);var l=y.l.MergeMeshes([s,c]);l.material=a,l.name=l.id="obstacle",l.position=new y.v(180,50,125),s.dispose(),c.dispose();var m=n.clone("obstacle");m.position=new y.v(100,50,-125),m.material=a;var u=n.clone("obstacle");u.position=new y.v(150,50,-125);var d=n.clone("obstacle");d.position=new y.v(-100,50,125);var f=n.clone("obstacle");f.position=new y.v(-150,50,125),f.material=a;var g=n.clone("obstacle");g.position=new y.v(22,0,2.5);var h=n.clone("obstacle");h.position=new y.v(-22,0,2.5);var p=y.l.MergeMeshes([g,h]);p.material=o,p.name=p.id="obstacle",p.position=new y.v(-180,50,-125),g.dispose(),h.dispose();var v=n.clone("obstacle");v.position=new y.v(-180,100,-150),v.scaling.z=1;var w=n.clone("obstacle");w.position=new y.v(180,100,100),w.scaling.z=1,w.material=i;var b=n.clone("obstacle");b.position=new y.v(250,38,150),b.scaling.z=1,b.scaling.y=1,b.material=o;var M=n.clone("obstacle");M.position=new y.v(-250,38,-100),M.scaling.z=1,M.scaling.y=1,M.material=a,r.getShadowMap().renderList.push(l,m,u,d,f,p,v,w,b,M),Ee.push(l,m,u,d,f,p,v,w,b,M),n.setEnabled(!1)}));var ke=y.m.CreateCylinder("moveArea",{height:.25,diameter:202,tessellation:256},e);ke.material=l,ke.actionManager=V,ke.setEnabled(!1),ke.position=new y.v(0,26,0);var Ne,Se,Oe=y.m.CreateCylinder("moveArea",{height:.25,diameter:227.25,tessellation:256},e);Oe.material=L,Oe.parent=ke,y.q.ImportMesh("","",".".concat("","/Models/setting.babylon"),e,(function(t){(Ne=t[0]).scaling=new y.v(1150,1200,1e3),Ne.material=x,r.getShadowMap().renderList.push(Ne),(Se=y.m.CreateBox("map",{width:808,height:606,depth:1},e)).rotate(y.d.X,y.u.ToRadians(90),e),Se.material=E,Se.receiveShadows=!0,Se.translate(y.d.Y,25,e),Se.actionManager=K}));var Be=function(){"teamWhite"===G.team?(G.team="teamBlack",o.position=new y.v(-700,300,0),Me()):"teamBlack"===G.team&&(G.team="teamWhite",o.position=new y.v(700,300,0),Me()),$(),n.setCurrentPlayer({name:G.name,team:G.team})},Ce="",Te=[],Le=!1,Ae=!1,je={position:null,rotation:null},Ie=function(){Te.forEach((function(t){c.removeMesh(t),e.getMeshByName("".concat(Ce.id,"To").concat(t.id))&&e.removeMesh(e.getMeshByName("".concat(Ce.id,"To").concat(t.id)))})),Te=[],e.getMeshByName("directLOS")&&e.getMeshByName("directLOS").dispose(),t[X.team].minis.forEach((function(t){e.getMeshByName("".concat(t.id,"To").concat(Ce.id))&&e.removeMesh(e.getMeshByName("".concat(t.id,"To").concat(Ce.id))),ct(t),t.diceAssigned=0})),i.removeControl(Ze)},ze=function(t){if(1===t.sourceEvent.which){var n=t.meshUnderPointer;e.hoverCursor="pointer",Ce===n?0===Te.length&&Qe({skip:!0}):n.id.includes("Mini")&&(Ce&&c.removeMesh(Ce),G.turnActions>0&&(Ie(),c.addMesh(n,y.f.White()),c.addMesh(ke,y.f.White()),Ce=n,je.position=Ce.position,ke.position=new y.v(n.position.x,26,n.position.z),ke.setEnabled(!0)))}},We=function(){Ce&&Ae&&!Le?(je.position&&(Ce.position=je.position,Ce.rotation=je.rotation,ke.setEnabled(!0),ke.position=new y.v(je.position.x,26,je.position.z),e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!1),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!1)),a.removeEventListener("mousemove",et),Ae=!1):Ce&&!Ae&&(ke.setEnabled(!1),c.removeMesh(Ce),c.removeMesh(ke),Ie(),e.removeMesh(be),e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!1),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!1),Me(),Ce="",e.hoverCursor="pointer",be&&be.dispose())},Re=function(t,n){var a=new y.v(t.position.x,t.position.y+5,t.position.z-t.width/2),i=new y.v(t.position.x,t.position.y+5,t.position.z+t.width/2),o=new y.v(n.position.x,n.position.y+5,n.position.z),s=o.subtract(a);s=y.v.Normalize(s);var r=o.subtract(i);r=y.v.Normalize(r);var c=he(t)/2+he(t),l=new y.o(a,s,c),m=new y.o(i,r,c),u=e.multiPickWithRay(l),d=e.multiPickWithRay(m);return!!u.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||!!d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))},Pe=function(e,t){var n=$e(e),a=new y.v(e.position.x,55,e.position.z),i=new y.v(t.position.x,55,t.position.z).subtract(a);return i=y.v.Normalize(i),!(180*Math.acos(y.v.Dot(n,i))/Math.PI>90)},_e=function(t){var n=new y.v(t.position.x,t.position.y,t.position.z+he(t)/2),a=new y.v(t.position.x,t.position.y,t.position.z-he(t)/2),i=new y.v(t.position.x+he(t)/2,t.position.y,t.position.z),o=new y.v(t.position.x-he(t)/2,t.position.y,t.position.z),s=new y.v(0,-1,0),r=ge(t)/2,c=new y.o(n,s,r),l=new y.o(a,s,r),m=new y.o(i,s,r),u=new y.o(o,s,r),d=e.multiPickWithRay(c),f=e.multiPickWithRay(l),g=e.multiPickWithRay(m),h=e.multiPickWithRay(u);return d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?d.filter((function(e){return e.pickedMesh.name.includes("obstacle")})).map((function(e){return e.pickedMesh}))[0]:f.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?f.filter((function(e){return e.pickedMesh.name.includes("obstacle")})).map((function(e){return e.pickedMesh}))[0]:g.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?g.filter((function(e){return e.pickedMesh.name.includes("obstacle")})).map((function(e){return e.pickedMesh}))[0]:h.some((function(e){return e.pickedMesh.name.includes("obstacle")}))?h.filter((function(e){return e.pickedMesh.name.includes("obstacle")})).map((function(e){return e.pickedMesh}))[0]:d.some((function(e){return e.pickedMesh.name.includes("map")}))?d.filter((function(e){return e.pickedMesh.name.includes("map")})).map((function(e){return e.pickedMesh}))[0]:void 0},De=function(t){e.getMeshByName("".concat(t.id,"shield"))&&e.getMeshByName("".concat(t.id,"shield")).setEnabled(!1)},Fe=function(t){var n,a,i=t.meshUnderPointer;Ce&&Ye(Ce,i)&&st(Ce,i)<=6&&(Re(n=Ce,a=i)?e.getMeshByName("".concat(n.id,"shield")).setEnabled(!0):e.getMeshByName("".concat(n.id,"shield"))&&e.getMeshByName("".concat(n.id,"shield")).setEnabled(!1),Re(a,n)?e.getMeshByName("".concat(a.id,"shield")).setEnabled(!0):e.getMeshByName("".concat(a.id,"shield"))&&e.getMeshByName("".concat(a.id,"shield")).setEnabled(!1),i.intersectsMesh(Ce,!1)||(Ye(Ce,i)?(e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!0),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!0),ke.setEnabled(!1)):i.intersectsMesh(Ce,!1)||Ye(Ce,i)||(ke.setEnabled(!1),e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!0),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!0))))},Je=function(){Ce&&(e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!1),e.getMeshByName("".concat(Ce.id,"shield")).setEnabled(!1),t[X.team].minis.forEach((function(t){return e.getMeshByName("".concat(t.id,"lineOfSight")).setEnabled(!1)})),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!1),Ae||0!==Te.length||ke.setEnabled(!0),De(Ce),t[X.team].minis.forEach((function(e){De(e)}))),e.hoverCursor="pointer"},Ue=function(e){for(var t=[],n=0;n<e;n++)t.push(Math.floor(6*Math.random())+1);return t},qe=function(t,n,a,i){for(var o=new y.v(n.position.x+10,n.position.y+7,n.position.z+30),s=new y.v(n.position.x+10,n.position.y+7,n.position.z+45),r=new y.v(n.position.x+-5,n.position.y+7,n.position.z+30),c=new y.v(n.position.x+-5,n.position.y+7,n.position.z+37.5),l=new y.v(n.position.x+-5,n.position.y+7,n.position.z+45),m=new y.v(n.position.x+-20,n.position.y+7,n.position.z+30),u=new y.v(n.position.x+-20,n.position.y+7,n.position.z+37.5),d=[o,s,r,l,m,new y.v(n.position.x+-20,n.position.y+7,n.position.z+45)],f=function(o){h=o+1,i?ee[t[o]-1].material=C:n.team.includes("White")?ee[t[o]-1].material=O:n.team.includes("Black")&&(ee[t[o]-1].material=B),3===t.length&&3===h?ee[t[o]-1].clone("diceClone".concat(o)).position=c:5===t.length&&5===h?ee[t[o]-1].clone("diceClone".concat(o)).position=u:ee[t[o]-1].clone("diceClone".concat(o)).position=d[o],setTimeout((function(){e.removeMesh(e.getMeshByName("diceClone".concat(o)))}),a)},g=0;g<t.length;g++){var h;f(g)}},He=function(e,a,i,o,s,r){var c=a.filter((function(n){return n+i>=t[e.team].armyStats.units[e.unit].range.success})),l=s.filter((function(e){return e+r>=t[o.team].armyStats.units[o.unit].defense.success}));n.log("".concat(G.name," rolls ").concat(a.toString()," with ").concat(0===i?"no":i>0?"a + ".concat(i):"a ".concat(i)," modifier to dice roll.")),c.length>0?n.log("".concat(G.name,"'s success ").concat(c.length>1?"rolls are":"roll is"," ").concat(c.toString(),".")):n.log("".concat(G.name," has no successful rolls.")),n.log("".concat(X.name," rolls ").concat(s.toString()," with ").concat(0===r?"no":r>0?"a + ".concat(r):"a ".concat(r)," modifier to dice roll.")),l.length>0?n.log("".concat(X.name,"'s success ").concat(l.length>1?"rolls are":"roll is"," ").concat(l.toString(),".")):n.log("".concat(X.name," has no successful rolls."));for(var m=0;m<c.length;m++)for(var u=0;u<l.length;u++)c[m]===l[u]&&(c.splice(m,1),l.splice(u,1));return Math.max.apply(Math,Object(v.a)(c))>Math.max.apply(Math,Object(v.a)(l))?(n.log("".concat(G.name," wins with a higher roll!")),e.id):Math.max.apply(Math,Object(v.a)(l))>Math.max.apply(Math,Object(v.a)(c))?(n.log("".concat(X.name," wins with a higher roll!")),o.id):null},Ye=function(n,a){var i,o=y.v.Distance(n.position,a.position)-a.width/2,s=t[n.team].armyStats.units[n.unit].maxRange;return o<=n.width/2+a.width/2?i="c":o<=202?i="s":o>202&&o<=404?i="m":o>404&&o<=808?i="l":o>808&&o<=s?i="xl":o>s&&(i=null),function(t,n){var a=new y.v(t.position.x,t.position.y+.75*ge(t),t.position.z),i=new y.v(n.position.x,n.position.y+.75*ge(n),n.position.z-n.width/2+.25*n.width),o=new y.v(n.position.x,n.position.y+.75*ge(n),n.position.z+n.width/2-.25*n.width),s=i.subtract(a);s=y.v.Normalize(s);var r=o.subtract(a);r=y.v.Normalize(r);var c=y.v.Distance(t.position,n.position)-he(n)/2,l=new y.o(a,s,c),m=new y.o(a,r,c),u=e.multiPickWithRay(l),d=e.multiPickWithRay(m);return!u.some((function(e){return e.pickedMesh.name.includes("obstacle")}))||!d.some((function(e){return e.pickedMesh.name.includes("obstacle")}))}(n,a)&&Pe(n,a)?i:null},Ge=function(){var e="";return 0===t.teamBlack.startActions&&0===t.teamWhite.startActions?(e=null,n.log("Game Over. It's a tie! No Winners this time.")):0===t.teamBlack.startActions?(e="Team White",n.log("Game Over. ".concat(t.teamWhite.name," wins!"))):0===t.teamWhite.startActions?(e="Team Black",n.log("Game Over. ".concat(t.teamBlack.name," wins!"))):e=void 0,e},Xe=function(e,n){var a=Ye(e,n),i=function(e,t){return e.position.y>t.position.y+ge(t)}(e,n)?1:0;return(Re(n,e)?-1:0)+i+t[e.team].armyStats.units[e.unit].range.mods[a]},Ke=function(a,i,s){var r="";if(a){var c=Ye(a,i),l=Re(a,i)?1:0,m=Xe(a,i),u=Re(i,a)?1:0,d=Xe(i,a);if(c&&Pe(a,i)){if(i.intersectsMesh(a,!1)||"c"===c){n.log("Melee attack of the ".concat(a.name," on the ").concat(i.name,".")),n.log("".concat(G.name,"'s target roll is ").concat(G.army.units[a.unit].melee.success,"+."));var f=Ue(G.army.units[a.unit].melee.roll);qe(f,a,1e3),n.log("".concat(X.name,"'s target roll is ").concat(X.army.units[a.unit].melee.success,"+."));var g=Ue(1);qe(g,i,1e3),r=He(a,f,0,i,g,0)}else{var h=[],p=[],v=[];n.log("".concat(t[a.team].name," is shooting the ").concat(i.name).concat(s?" in response":""," with the ").concat(a.name," at range ").concat(c.toUpperCase(),".")),n.log("".concat(t[a.team].name,"'s target roll is ").concat(G.army.units[a.unit].range.success,"+.")),h=Ue(s?1:i.diceAssigned),qe(h,a,1e3),p=h.map((function(e){return e+m})),Ye(i,a)&&!s&&(n.log("".concat(X.name,"'s target roll is ").concat(X.army.units[i.unit].defense.success,"+.")),v=Ue(1),qe(v,i,1e3),r=He(a,h,m,i,v,d)),r||p.some((function(e){return e>=G.army.units[a.unit].range.success}))&&(s?n.log("".concat(X.name," rolls ").concat(h.toString(),". Hot damn! The ").concat(i.name," got shot!")):n.log("".concat(G.name," rolls ").concat(h.toString(),". Success! You shot your opponent's ").concat(i.name,"!")),r=a.id)}if(r===a.id){n.log("".concat(t[i.team].name,"'s ").concat(i.name," is hit. Defense roll target is ").concat(t[i.team].armyStats.units[i.unit].defense.success,"+")),u>0&&n.log("".concat(t[i.team].name," has +1 to dice roll for ").concat(i.id," as it is in cover."));var w=Ue(t[i.team].armyStats.units[i.unit].defense.roll);n.log("".concat(t[i.team].name," rolls ").concat(w.toString(),".")),setTimeout((function(){qe(w,i,1250,!0)}),1250),w.some((function(e){return e+u>=t[i.team].armyStats.units[i.unit].defense.success}))?n.log("Defense roll successful. The ".concat(i.name," is saved!")):(n.log("The ".concat(i.name," is killed!")),setTimeout((function(){i.position=new y.v(Math.floor(190*Math.random())-200,0,-440+Math.floor(30*Math.random())-15),i.name="decor",i.isPickable=!1,e.getMeshByName("".concat(i.id,"To").concat(a.id))&&e.removeMesh(e.getMeshByName("".concat(i.id,"To").concat(a.id))),n.removePlayerMini(i.id,i.team),De(i),ot(i),s&&We()}),2500))}else if(r===i.id){n.log("".concat(t[a.team].name,"'s ").concat(a.name," is hit. Defense roll target is ").concat(t[i.team].armyStats.units[i.unit].defense.success,"+")),l>0&&n.log("".concat(t[a.team].name," has +1 to dice roll for the ").concat(a.name," as it is in cover."));var b=Ue(t[a.team].armyStats.units[a.unit].defense.roll);n.log("".concat(t[a.team].name," rolls ").concat(b.toString(),".")),setTimeout((function(){qe(b,a,1250,!0)}),1250),b.some((function(e){return e+l>=t[a.team].armyStats.units[a.unit].defense.success}))?n.log("Defense roll successful. The ".concat(a.name," is saved!")):(n.log("The ".concat(a.name," is killed!")),setTimeout((function(){o.target=Se,a.position=new y.v(200-Math.floor(190*Math.random()),0,-440+Math.floor(30*Math.random())-15),a.name="decor",a.isPickable=!1,n.removePlayerMini(a.id,a.team),De(a),We()}),2500))}else n.log("No winners! Try again.")}}},Ve=function(){var a=Object(u.a)(m.a.mark((function a(){var i,o,s;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(Le=!0,i=function(e){return new Promise((function(t){return setTimeout(t,e)}))},!(Ce&&Te&&Te.length>0)){a.next=17;break}return o=t[X.team].minis.filter((function(e){return X.army.units[e.unit].range.mods[Ye(e,Ce)]>=0})),s=o.filter((function(e){return!Te.some((function(t){return t===e}))})),a.next=7,ye(Te,function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce&&Ke(Ce,t),e.next=3,i(3e3);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:if(!s){a.next=10;break}return a.next=10,ye(s,function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce&&Ke(t,Ce,!0),e.next=3,i(3e3);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:n.removeTurnAction(G.team),e.removeMesh(e.getMeshByName("token")),Je(),We(),Ge(),Le=!1,0===t[G.team].turnActions&&setTimeout((function(){Be()}),3500);case 17:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),Ze=w.a.CreateSimpleButton("rollButton","Roll Dice");Ze.width="120px",Ze.height="60px",Ze.color="white",Ze.left="40%",Ze.top="30%",Ze.cornerRadius=20,Ze.background="black",Ze.zIndex=2e3,Ze.onPointerClickObservable.add((function(){Le||Ve()}));var Qe=function(t){var n=t.skip;if(Ce){if(n||(je.position=Ce.position,Ce.position=be.position),ke.position=new y.v(Ce.position.x,26,Ce.position.z),ke.setEnabled(!1),e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!0),_e(Ce)&&_e(Ce).name.includes("obstacle")){e.getMeshByName("groundLOS".concat(Ce.id))?(e.getMeshByName("groundLOS".concat(Ce.id)).position.y=26-Ce.position.y,e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!0)):e.getMeshByName("".concat(Ce.id,"lineOfSight")).clone("groundLOS".concat(Ce.id)).position.y=26-Ce.position.y,e.getMeshByName("groundMoveArea")?e.getMeshByName("groundMoveArea").position.y=Ce.position.y-ge(Ce)/2-5:(ke.clone("groundMoveArea"),e.getMeshByName("groundMoveArea").parent=ke,e.getMeshByName("groundMoveArea").position=new y.v(0,Ce.position.y-ge(Ce)/2-5,0));var a="if( vPositionW.z  < ".concat(Math.round(_e(Ce).position.z-pe(_e(Ce))/2),".){ discard; } if( vPositionW.z  > ").concat(Math.round(_e(Ce).position.z+pe(_e(Ce))/2),".){ discard; } if( vPositionW.x  > ").concat(Math.round(_e(Ce).position.x+he(_e(Ce))/2),".){ discard; } if( vPositionW.x  < ").concat(Math.round(_e(Ce).position.x-he(_e(Ce))/2),".){ discard; }"),i=new M.a("highMat",e);i.alpha=.25,i.Fragment_Custom_Diffuse(a),i.diffuseColor=e.getMaterialByName(Ce.losMat[0]).diffuseColor,e.getMeshByName("".concat(Ce.id,"lineOfSight")).material=i,e.getMeshByName("".concat(Ce.id,"lineOfSight"))._children.forEach((function(t,n){t.material=new M.a("highMat".concat(n),e),t.material.alpha=.25,t.material.Fragment_Custom_Diffuse(a),t.material.diffuseColor=e.getMaterialByName(Ce.losMat[n+1]).diffuseColor})),e.getMeshByName("groundMoveArea").material=new M.a("highMoveMat",e),e.getMeshByName("groundMoveArea").material.alpha=.25,e.getMeshByName("groundMoveArea").material.Fragment_Custom_Diffuse(a),e.getMeshByName("groundMoveArea")._children.forEach((function(e){return e.setEnabled(!1)}))}else e.getMeshByName("".concat(Ce.id,"lineOfSight")).material=e.getMaterialByName(Ce.losMat[0]),e.getMeshByName("".concat(Ce.id,"lineOfSight"))._children.forEach((function(t,n){return t.material=e.getMaterialByName(Ce.losMat[n+1])})),Oe.material=L,e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).dispose(),e.getMeshByName("groundMoveArea")&&e.getMeshByName("groundMoveArea").dispose();je.rotation=Ce.rotation.clone(),Ae=!0}},$e=function(e){var t=new y.v(0,0,-1),n=e.getDirection(t);return n.normalize(),n},et=function(e){if(e.preventDefault(),Ce&&at(e)){var t=Ce.position.x-at(e).x,n=Ce.position.z-at(e).z;Ce.rotation.y=Math.atan2(t,n)}},tt=function(a){1!==a.which&&1!==a.sourceEvent.which||Ce&&Ae&&(n.removeTurnAction(G.team),e.removeMesh(e.getMeshByName("token")),Ae=!1,je.position=null,je.rotation=null,We(),0===t[G.team].turnActions&&setTimeout((function(){Be()}),1e3))},nt=function(e){if((e.preventDefault(),Ce&&at(e))&&(![].concat(Object(v.a)(t[X.team].minis),Object(v.a)(t[G.team].minis.filter((function(e){return e.id!==Ce.id})))).some((function(t){return at(e).x<t.position.x+he(t)-2&&at(e).x>t.position.x-he(t)+2&&at(e).z<t.position.z+he(t)-2&&at(e).z>t.position.z-he(t)+2}))&&!Ee.filter((function(e){return ge(e)+e.position.y-ge(e)/2>ge(Ce)+Ce.position.y})).some((function(t){return at(e).x<t.position.x+he(t)/2+he(Ce)/2&&at(e).x>t.position.x-he(t)/2-he(Ce)/2&&at(e).z<t.position.z+pe(t)/2+he(Ce)/2&&at(e).z>t.position.z-pe(t)/2-he(Ce)/2}))&&at(e).x>-388&&at(e).x<388&&at(e).z>-285&&at(e).z<285)){var n=Ee.filter((function(e){return ge(e)<ge(Ce)+Ce.position.y-25})).filter((function(t){return at(e).x<t.position.x+he(t)/2+he(Ce)/2&&at(e).x>t.position.x-he(t)/2-he(Ce)/2&&at(e).z<t.position.z+pe(t)/2+he(Ce)/2&&at(e).z>t.position.z-pe(t)/2-he(Ce)/2}));n&&n.length>0?be.position=new y.v(at(e).x,ge(n[0])+26,at(e).z):be.position=new y.v(at(e).x,25,at(e).z)}},at=function(){var t=e.pick(e.pointerX,e.pointerY,(function(e){return e===Se}));return t.hit?t.pickedPoint:null},it=function(e){i.addControl(Ze),lt();var t=new y.f.Black;Ce&&!Te.some((function(t){return t.id===e.id}))&&(fe(Ce.unit,G.team,Ye(Ce,e))&&(t=fe(Ce.unit,G.team,Ye(Ce,e))),c.addMesh(e,t),Te.push(e),"c"!==Ye(Ce,e)&&ut(Ce,e,!1),rt(e),dt())},ot=function(t){t&&(t.diceAssigned=0),Te.forEach((function(t,n){0===t.diceAssigned&&(Te.splice(n,1),c.removeMesh(t),ct(t),e.removeMesh(e.getMeshByName("".concat(Ce.id,"To").concat(t.id))))}))},st=function(e,t){var n,a;return"c"===Ye(e,t)?a=G.army.units[e.unit].melee.success:(n=Xe(e,t),a=G.army.units[e.unit].range.success-n),a},rt=function(e){if(Ce){var t=e.diceAssigned,n=st(Ce,e),a=new w.b("".concat(e.id,"diceStat"));a.text="".concat(t,"d").concat(n,"+"),a.color="white",a.fontFamily="Arial",a.fontSize="15px",i.addControl(a),a.linkWithMesh(e),a.linkOffsetY=-40}},ct=function(e){ve("".concat(e.id,"diceStat"))&&ve("".concat(e.id,"diceStat")).dispose()},lt=function(){Te&&Te.length>0&&Te.forEach((function(e){ct(e),rt(e)}))},mt=function(e){var t=e.meshUnderPointer,n=Te.map((function(e){return e.diceAssigned})).indexOf(Math.max.apply(Math,Object(v.a)(Te.filter((function(e){return e.id!==t.id})).map((function(e){return e.diceAssigned})))));if(Ce&&t&&t.id.includes("Mini")&&Ye(Ce,t)&&st(Ce,t)<=6)if(ke.setEnabled(!1),0===Te.length)t.diceAssigned=G.army.units[Ce.unit].range.roll,it(t);else if(n>=0&&Te.reduce((function(e,t){return e+t.diceAssigned}),0)===G.army.units[Ce.unit].range.roll&&Te.filter((function(e){return e.id!==t.id})).every((function(e){return e.diceAssigned>=1})))t.diceAssigned?t.diceAssigned+=1:t.diceAssigned=1,Te[n].diceAssigned-=1,it(t),ot();else{if(Te.length>1&&Te.every((function(e){return 1===e.diceAssigned}))){var a=Te.splice(Te.indexOf(Te[n]),1)[0];ot(a),t.diceAssigned?t.diceAssigned+=1:t.diceAssigned=1,it(t)}t.diceAssigned===G.army.units[Ce.unit].range.roll&&(ot(t),Ie())}},ut=function(t,n,a){var i,o;if(a){i=new y.v(t.position.x,t.position.y+.7*ge(t),t.position.z),o=new y.v(n.position.x,n.position.y+.7*ge(n),n.position.z);var s=[new y.g(215/255,195/255,58/255,1),new y.g(0,0,0,0)];y.m.CreateLines("".concat(t.id,"To").concat(n.id),{points:[i,o],colors:s,updatable:!0},e)}else{i=new y.v(t.position.x,t.position.y+.8*ge(t),t.position.z),o=new y.v(n.position.x,n.position.y+.8*ge(n),n.position.z);var r=[new y.g(1,1,1,1),new y.g(0,0,0,0)];y.m.CreateLines("".concat(t.id,"To").concat(n.id),{points:[i,o],colors:r,updatable:!0},e)}},dt=function(){Ce&&Te&&t[X.team].minis.forEach((function(t){e.getMeshByName("".concat(t.id,"To").concat(Ce.id))||(X.army.units[t.unit].range.mods[Ye(t,Ce)]>=0||e.getMeshByName("".concat(Ce.id,"To").concat(t.id)))&&ut(t,Ce,!0)}))};V.registerAction(new y.i(y.a.OnPointerOverTrigger,(function(e){(be=Ce.clone()).position=Ce.position,be.isPickable=!1,be._children.forEach((function(e){return e.setEnabled(!1)})),be.material=d,a.addEventListener("mousemove",nt,!1),a.addEventListener("click",Qe,!1)}))),V.registerAction(new y.i(y.a.OnPointerOutTrigger,(function(e){be.dispose(),a.removeEventListener("mousemove",nt),a.removeEventListener("click",Qe)}))),K.registerAction(new y.i(y.a.OnPointerOverTrigger,(function(t){Ce&&Ae&&e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!0),Ae&&(a.addEventListener("mousemove",et,!1),a.addEventListener("click",tt,!1))}))),K.registerAction(new y.i(y.a.OnPointerOutTrigger,(function(t){Ce&&!Ae&&(e.getMeshByName("".concat(Ce.id,"lineOfSight")).setEnabled(!1),e.getMeshByName("groundLOS".concat(Ce.id))&&e.getMeshByName("groundLOS".concat(Ce.id)).setEnabled(!1)),a.removeEventListener("mousemove",et),a.removeEventListener("click",tt)}))),Z.registerAction(new y.i(y.a.OnPickUpTrigger,(function(e){"teamBlack"!==G.team||Le||(Ae?tt(e):ze(e))}))),Z.registerAction(new y.i(y.a.OnLeftPickTrigger,(function(e){"teamWhite"!==G.team||Ae||Le||mt(e)}))),Z.registerAction(new y.i(y.a.OnPointerOverTrigger,(function(e){"teamWhite"!==G.team||Le||Fe(e)}))),Z.registerAction(new y.i(y.a.OnPointerOutTrigger,(function(e){"teamWhite"===G.team&&Je()}))),Q.registerAction(new y.i(y.a.OnPickUpTrigger,(function(e){"teamWhite"!==G.team||Le||(Ae?tt(e):ze(e))}))),Q.registerAction(new y.i(y.a.OnLeftPickTrigger,(function(e){"teamBlack"!==G.team||Ae||Le||mt(e)}))),Q.registerAction(new y.i(y.a.OnPointerOverTrigger,(function(e){"teamBlack"!==G.team||Le||Fe(e)}))),Q.registerAction(new y.i(y.a.OnPointerOutTrigger,(function(e){"teamBlack"===G.team&&Je()}))),a.addEventListener("contextmenu",We,!1),e.onDispose=function(){a.removeEventListener("mousemove",nt),a.removeEventListener("contextmenu",We)}},S=function(e){return i.a.createElement("div",null,i.a.createElement(k,{id:"my-canvas",className:"w-full h-full",antialias:!0,onSceneReady:N}))},O=function(){var e=Object(a.useState)(!1),t=Object(x.a)(e,2),n=t[0],o=t[1],s=Object(a.useState)(!1),l=Object(x.a)(s,1)[0],m=i.a.useContext(p),u=function(){return Object(r.b)((function(){return Object(c.toJS)(m.gameInfo)?i.a.createElement("p",{className:"block mt-0 inline-block text-gray-400"},Object(c.toJS)(m.gameInfo.currentPlayer.name),"'s turn"):i.a.createElement(i.a.Fragment,null)}))},d=function(){return Object(r.b)((function(){if(Object(c.toJS)(m.gameInfo)){var e=Math.round(100-Object(c.toJS)(m.gameInfo.players.teamWhite.minis).length/Object(c.toJS)(m.gameInfo.players.teamWhite.units).length*100),t=Math.round(100-Object(c.toJS)(m.gameInfo.players.teamBlack.minis).length/Object(c.toJS)(m.gameInfo.players.teamBlack.units).length*100);return i.a.createElement("p",{className:"hidden lg:block mt-0 inline-block mt-0 text-gray-400 mr-4"},"Progression ".concat(Math.max(t,e),"%"))}return i.a.createElement(i.a.Fragment,null)}))},f=function(){return Object(r.b)((function(){if(Object(c.toJS)(m.gameInfo)){var e=m.gameInfo.players[m.gameInfo.currentPlayer.team].timeLeft,t=Math.floor(e/60),n=e-60*t;return i.a.createElement("span",{className:"font-semibold text-xl tracking-tight"},"".concat(t,":").concat(0===n?"00":n))}return i.a.createElement("span",{className:"font-semibold text-xl tracking-tight"},"Time left")}))};return i.a.createElement("nav",{className:"flex items-center justify-between lg:flex-wrap bg-gray-700 p-4"},i.a.createElement("div",{className:"flex flex-col lg:flex-row"},i.a.createElement("div",{className:"flex items-center flex-shrink-0 text-white mr-6"},i.a.createElement("span",{className:"font-semibold text-xl tracking-tight"},"IN/SYS")),i.a.createElement("div",{className:"text-sm flex flex-col"},i.a.createElement("p",{className:"block mt-0 inline-block mt-0 text-gray-400 mr-4 hidden md:block"},"Table #".concat(m.gameInfo.tableNumber)),i.a.createElement(d,null))),i.a.createElement("div",{className:"flex flex-col items-center justify-center"},i.a.createElement("div",{className:"text-sm flex flex-col"}),i.a.createElement("div",{className:"flex flex-col items-center flex-shrink-0 text-white"},i.a.createElement(u,null),i.a.createElement(f,null))),i.a.createElement("div",{className:"flex flex-row"},i.a.createElement("button",{type:"button",className:"flex items-center px-3 py-2 rounded text-gray-200 border-gray-400 hover:text-white hover:border-white hidden md:block"},l?i.a.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"volume-up w-6 h-6"},i.a.createElement("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})):i.a.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"volume-off w-6 h-6"},i.a.createElement("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"}))),i.a.createElement("button",{onClick:m.toggleFullScreen,type:"button",className:"flex items-center px-3 py-2 rounded text-gray-200 border-gray-400 hover:text-white hover:border-white hidden md:block"},i.a.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"arrows-expand w-6 h-6"},i.a.createElement("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z",clipRule:"evenodd"}))),i.a.createElement("button",{onClick:function(){return o(!n)},type:"button",className:"flex items-center px-3 py-2 rounded text-gray-200 border-gray-400 hover:text-white hover:border-white"},i.a.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"cog w-6 h-6"},i.a.createElement("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})))))},B=function(){return i.a.createElement("div",{className:"w-screen bg-gray-700 py-6 px-8 lg:px-32"},i.a.createElement("ul",{className:"w-full list-none flex flex-row flex-wrap justify-center lg:justify-around items-center text-white"},i.a.createElement("li",{className:"px-2"},"Factions"),i.a.createElement("li",{className:"px-2"},"Store"),i.a.createElement("li",{className:"px-2"},"Market"),i.a.createElement("li",{className:"px-2"},"Battle"),i.a.createElement("li",{className:"px-2"},i.a.createElement("a",{href:"https://hive.blog/@jrej",target:"_blank",rel:"noopener noreferrer",title:"Inkito blog"},"Blog"))))},C=function(e){var t=e.team,n=e.playerName,a=e.actionsLeft,o=e.minisLeft,s=e.isCurrentPlayer;return i.a.createElement("div",{className:"w-full flex flex-col md:flex-row flex-grow items-center justify-center lg:justify-start bg-gray-500 p-2 lg:p-8 mx-4 my-2 lg:mb-0 lg:mr-0 lg:pr-8 rounded-md lg:rounded-l-md lg:rounded-r-none"},i.a.createElement("div",{className:"relative flex flex-col w-16 items-center justify-center"},s?i.a.createElement("div",{className:"absolute loader ease-linear rounded-full border-8 border-t-8 border-gray-500 h-16 w-16 top-6/12 left-6/12"}):null,n?i.a.createElement("img",{className:"z-10 w-12 h-12 rounded-full flex items-center justify-center border-4 border-".concat(t),src:"https://images.hive.blog/u/".concat(n.toLowerCase(),"/avatar"),alt:"avatar"}):i.a.createElement("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"user-circle w-10 h-10"},i.a.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"}))),i.a.createElement("div",{className:"flex flex-col flex-grow justify-center"},i.a.createElement("div",{className:"flex flex-col md:flex-row flex-wrap w-full items-center justify-center lg:justify-between"},i.a.createElement("p",{className:"mt-0 mr-2 lg:ml-4 lg:mr-0 font-bold text-".concat(t)},n),i.a.createElement("p",{className:"mt-0 lg:ml-4"},"Time left")),i.a.createElement("div",{className:"flex flex-row flex-wrap justify-center items-center lg:justify-between lg:ml-4"},i.a.createElement("div",{className:"flex flex-row flex-wrap actions mr-2"},i.a.createElement("p",{className:"mt-0"},"Actions:"),i.a.createElement("p",{className:"mt-0 ml-2"},a)),i.a.createElement("div",{className:"flex flex-row flex-wrap actions"},i.a.createElement("p",{className:"mt-0"},"Minis:"),i.a.createElement("p",{className:"mt-0 ml-2"},o)))))},T=function(){var e=i.a.useContext(p);return Object(r.b)((function(){if(e.gameInfo){for(var t=Object(c.toJS)(e.gameInfo.history),n=[],a=[],o=0;o<t.length;o++){if(t[o]&&t[o].includes(e.gameInfo.players.teamWhite.name)){var s=t[o].split(e.gameInfo.players.teamWhite.name);a=[i.a.createElement("span",{key:s[0]},s[0]),i.a.createElement("span",{key:e.gameInfo.players.teamWhite.name,className:"text-white font-bold"},e.gameInfo.players.teamWhite.name),i.a.createElement("span",{key:s[1]},s[1])]}else if(t[o]&&t[o].includes(e.gameInfo.players.teamBlack.name)){var r=t[o].split(e.gameInfo.players.teamBlack.name);a=[i.a.createElement("span",{key:r[0]},r[0]),i.a.createElement("span",{key:e.gameInfo.players.teamBlack.name,className:"text-black font-bold"},e.gameInfo.players.teamBlack.name),i.a.createElement("span",{key:r[1]},r[1])]}else a=[t[o]];n.unshift(i.a.createElement("div",{key:o,className:"bg-gray-500 hidden rounded-sm lg:block m-2 p-2"},a))}return i.a.createElement("div",{className:"scroll-bar overflow-auto my-4 pb-1 mx-1 hidden lg:block w-auto",style:{height:1.75*e.canvasHeight}},n)}return i.a.createElement(i.a.Fragment,null)}))},L=function(e){var t=e.unit;return i.a.createElement("div",{className:"border flex-grow max-w-md lg:max-w-xs rounded-md m-4"},i.a.createElement("div",{id:"unit-top-bar",className:"flex flex-row bg-gray-800 justify-between items-center p-2"},i.a.createElement("div",{className:"flex flex-row"},i.a.createElement("h1",{className:"mr-2 bg-".concat(t.color,"-600 p-2 rounded-md")},t.army),i.a.createElement("h2",{className:"bg-gray-400 p-2 rounded-md"},"".concat(t.class," unit"))),i.a.createElement("div",{className:"flex flex-row justify-end items-center"},i.a.createElement("span",{className:"text-red-500 hidden sm:block"},"Lives :"),i.a.createElement("span",{className:"dot rounded-full w-4 h-4 bg-red-500 ml-2"}))),i.a.createElement("div",{id:"unit-info-bar",className:"flex flex-row px-4 py-2 justify-center items-center bg-gray-500"},i.a.createElement("img",{className:"rounded-lg w-auto h-16",src:t.image,alt:"unit-avatar"}),i.a.createElement("div",{className:"flex flex-col flex-wrap justify-center items-start m-4"},i.a.createElement("p",null,"Name: ".concat(t.name)),i.a.createElement("p",null,"Equipment: ".concat(t.equipment.range," + ").concat(t.equipment.melee)))),i.a.createElement("div",{id:"unit-stat-bar",className:"w-auto"},i.a.createElement("table",{className:"table-fixed w-full"},i.a.createElement("thead",null,i.a.createElement("tr",{className:"bg-gray-600"},i.a.createElement("th",{className:"border px-4"},"Melee"),i.a.createElement("th",{className:"border px-4"},"Ranged"),i.a.createElement("th",{className:"border px-4"},"Defense"))),i.a.createElement("tbody",null,i.a.createElement("tr",{className:"bg-gray-500"},i.a.createElement("td",{className:"border px-4 py-2 text-center"},"".concat(t.melee.roll,"d").concat(t.melee.success,"+")),i.a.createElement("td",{className:"border px-4 py-2 text-center"},"".concat(t.range.roll,"d").concat(t.range.success,"+")),i.a.createElement("td",{className:"border px-4 py-2 text-center"},"".concat(t.defense.roll,"d").concat(t.defense.success,"+")))))),i.a.createElement("div",{id:"unit-spec-bar",className:"flex flex-row p-2 h-8 bg-white items-center"},"Special abilities: ".concat(t.specials)))},A=function(e){var t=e.team,n=i.a.useContext(p);return Object(r.b)((function(){if(Object(c.toJS)(n.gameInfo)&&Object(c.toJS)(n.gameInfo.players[t].minis)){for(var e=Object(c.toJS)(n.gameInfo.players[t].minis),a=[],o=0;o<e.length;o++)a.push(i.a.createElement(L,{key:t+o,unit:d[Object(c.toJS)(n.gameInfo.players)[t].army].units[e[o].unit]}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"w-auto h-auto min-h-full my-4 m-2 lg:mr-0"},i.a.createElement("div",{className:"w-full flex justify-start items-center bg-gray-600 border-b-2 border-gray-700 p-2 md:p-4"},i.a.createElement("h1",null,i.a.createElement("span",{className:"text-".concat(t.includes("White")?"white":"black"," font-bold")},Object(c.toJS)(n.gameInfo.players[t].name)),"'s miniatures:")),i.a.createElement("div",{className:"flex flex-row flex-wrap justify-center lg:justify-start items-center bg-gray-600 p-1 md:p-4 lg:px-12"},a)))}return i.a.createElement(i.a.Fragment,null)}))},j=function(){var e=i.a.useContext(p);Object(a.useEffect)((function(){return e.temporalLogin(),e.getUserDetail(),""===e.loginLink&&e.initHSLogin(),e.setTimer(),window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}));var t=function e(t){9===t.keyCode&&(document.body.classList.add("user-is-tabbing"),window.removeEventListener("keydown",e))},n=function(){return Object(r.b)((function(){return Object(c.toJS)(e.gameInfo)?i.a.createElement("div",{className:"".concat(e.fullScreen?"hidden":""," flex flex-col justify-between lg:w-3/12")},i.a.createElement("div",{className:"flex flex-row lg:flex-col items-center justify-center"},i.a.createElement(C,{team:"white",playerName:Object(c.toJS)(e.gameInfo.players.teamWhite.name),actionsLeft:Object(c.toJS)(e.gameInfo.players.teamWhite.turnActions),minisLeft:Object(c.toJS)(e.gameInfo.players.teamWhite.minis.length),isCurrentPlayer:Object(c.toJS)(e.gameInfo.currentPlayer.name)===Object(c.toJS)(e.gameInfo.players.teamWhite.name)}),i.a.createElement(C,{team:"black",playerName:Object(c.toJS)(e.gameInfo.players.teamBlack.name),actionsLeft:Object(c.toJS)(e.gameInfo.players.teamBlack.turnActions),minisLeft:Object(c.toJS)(e.gameInfo.players.teamBlack.minis.length),isCurrentPlayer:Object(c.toJS)(e.gameInfo.currentPlayer.name)===Object(c.toJS)(e.gameInfo.players.teamBlack.name)})),i.a.createElement(T,null)):i.a.createElement(i.a.Fragment,null)}))};return i.a.createElement("div",{className:"side-bar w-full h-full bg-gray-800 overflow-hidden"},i.a.createElement(O,null),i.a.createElement("div",{className:"flex flex-col-reverse lg:flex-row"},i.a.createElement("div",{className:"w-full h-full"},i.a.createElement(S,null),i.a.createElement(A,{team:"teamWhite"}),i.a.createElement(A,{team:"teamBlack"})),i.a.createElement(n,null)),i.a.createElement(B,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(h,null,i.a.createElement(j,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[179,1,2]]]);
//# sourceMappingURL=main.7e516dd8.chunk.js.map